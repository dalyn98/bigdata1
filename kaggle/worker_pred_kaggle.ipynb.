{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 151,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "from matplotlib import font_manager, rc\n",
    "import seaborn as sns\n",
    "import warnings\n",
    "from sklearn.metrics import roc_curve\n",
    "#from sklearn.preprocessing import Imputer\n",
    "from sklearn.model_selection import cross_val_score, StratifiedShuffleSplit\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.metrics import roc_auc_score\n",
    "from sklearn.metrics import f1_score\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.metrics import classification_report\n",
    "from imblearn.under_sampling import *\n",
    "from sklearn.decomposition import PCA\n",
    "from imblearn.combine import SMOTETomek\n",
    "from lightgbm import LGBMClassifier\n",
    "from sklearn.preprocessing import PolynomialFeatures\n",
    "from sklearn.impute import SimpleImputer\n",
    "from xgboost import XGBClassifier\n",
    "from imblearn.combine import *\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "warnings.filterwarnings('ignore')\n",
    "%matplotlib inline\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 152,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import roc_curve\n",
    "from sklearn.metrics import auc"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 153,
   "metadata": {},
   "outputs": [],
   "source": [
    "def plot_roc_curve(fpr, tpr, model, color=None) :\n",
    "    model = model + ' (auc = %0.3f)' % auc(fpr, tpr)\n",
    "    plt.plot(fpr, tpr, label=model, color=color)\n",
    "    plt.plot([0, 1], [0, 1], color='navy', linestyle='--')\n",
    "    plt.axis([0,1,0,1])\n",
    "    plt.xlabel('FPR (1 - specificity)')\n",
    "    plt.ylabel('TPR (recall)')\n",
    "    plt.title('ROC curve')\n",
    "    plt.legend(loc=\"lower right\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "from sklearn.metrics import accuracy_score, recall_score, precision_score, confusion_matrix\n",
    "def get_clf_eval(y_test, pred):\n",
    "    confusion = confusion_matrix(y_test, pred)\n",
    "    accuracy = accuracy_score(y_test, pred)\n",
    "    precision = precision_score(y_test, pred)\n",
    "    recall = recall_score(y_test, pred)\n",
    "    print('오차행렬')\n",
    "    print(confusion)\n",
    "    print('정확도: {0:.4f}, 정밀도: {1:.4f}, 재현율: {2:.4f}'.format(accuracy, precision, recall))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 247,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>성별</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>2174</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이              노동 계급  fnlwgt          학력  교육 수  \\\n",
       "0  H20001  39          State-gov   77516   Bachelors    13   \n",
       "1  H20002  50   Self-emp-not-inc   83311   Bachelors    13   \n",
       "2  H20003  38            Private  215646     HS-grad     9   \n",
       "3  H20004  53            Private  234721        11th     7   \n",
       "4  H20005  28            Private  338409   Bachelors    13   \n",
       "\n",
       "                 혼인 상태                  직업              관계      인종       성별  \\\n",
       "0        Never-married        Adm-clerical   Not-in-family   White     Male   \n",
       "1   Married-civ-spouse     Exec-managerial         Husband   White     Male   \n",
       "2             Divorced   Handlers-cleaners   Not-in-family   White     Male   \n",
       "3   Married-civ-spouse   Handlers-cleaners         Husband   Black     Male   \n",
       "4   Married-civ-spouse      Prof-specialty            Wife   Black   Female   \n",
       "\n",
       "   자본 이득  자본 손실  주당 시간              모국  \n",
       "0   2174      0     40   United-States  \n",
       "1      0      0     13   United-States  \n",
       "2      0      0     40   United-States  \n",
       "3      0      0     40   United-States  \n",
       "4      0      0     40            Cuba  "
      ]
     },
     "execution_count": 247,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "df = pd.read_csv('human.csv', encoding='cp949')\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 248,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "mdf = df.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 249,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 32561 entries, 0 to 32560\n",
      "Data columns (total 15 columns):\n",
      " #   Column  Non-Null Count  Dtype \n",
      "---  ------  --------------  ----- \n",
      " 0   아이디     32561 non-null  object\n",
      " 1   나이      32561 non-null  int64 \n",
      " 2   노동 계급   30725 non-null  object\n",
      " 3   fnlwgt  32561 non-null  int64 \n",
      " 4   학력      32561 non-null  object\n",
      " 5   교육 수    32561 non-null  int64 \n",
      " 6   혼인 상태   32561 non-null  object\n",
      " 7   직업      30718 non-null  object\n",
      " 8   관계      32561 non-null  object\n",
      " 9   인종      32561 non-null  object\n",
      " 10  성별      32561 non-null  object\n",
      " 11  자본 이득   32561 non-null  int64 \n",
      " 12  자본 손실   32561 non-null  int64 \n",
      " 13  주당 시간   32561 non-null  int64 \n",
      " 14  모국      31978 non-null  object\n",
      "dtypes: int64(6), object(9)\n",
      "memory usage: 3.7+ MB\n"
     ]
    }
   ],
   "source": [
    "mdf.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 250,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "40    15217\n",
       "50     2819\n",
       "45     1824\n",
       "60     1475\n",
       "35     1297\n",
       "      ...  \n",
       "92        1\n",
       "94        1\n",
       "87        1\n",
       "74        1\n",
       "82        1\n",
       "Name: 주당 시간, Length: 94, dtype: int64"
      ]
     },
     "execution_count": 250,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf['주당 시간'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 251,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    32561.000000\n",
       "mean        40.437456\n",
       "std         12.347429\n",
       "min          1.000000\n",
       "25%         40.000000\n",
       "50%         40.000000\n",
       "75%         45.000000\n",
       "max         99.000000\n",
       "Name: 주당 시간, dtype: float64"
      ]
     },
     "execution_count": 251,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf['주당 시간'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 252,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>성별</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>2174</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>15024</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>22980 rows × 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black   \n",
       "...                    ...                 ...             ...     ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White   \n",
       "32559        Never-married        Adm-clerical       Own-child   White   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White   \n",
       "\n",
       "            성별  자본 이득  자본 손실  주당 시간              모국  \n",
       "0         Male   2174      0     40   United-States  \n",
       "1         Male      0      0     13   United-States  \n",
       "2         Male      0      0     40   United-States  \n",
       "3         Male      0      0     40   United-States  \n",
       "4       Female      0      0     40            Cuba  \n",
       "...        ...    ...    ...    ...             ...  \n",
       "32556   Female      0      0     38   United-States  \n",
       "32557     Male      0      0     40   United-States  \n",
       "32558   Female      0      0     40   United-States  \n",
       "32559     Male      0      0     20   United-States  \n",
       "32560   Female  15024      0     40   United-States  \n",
       "\n",
       "[22980 rows x 15 columns]"
      ]
     },
     "execution_count": 252,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf.loc[mdf['주당 시간'] <= 40]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>성별</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>2174</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>15024</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black   \n",
       "...                    ...                 ...             ...     ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White   \n",
       "32559        Never-married        Adm-clerical       Own-child   White   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White   \n",
       "\n",
       "            성별  자본 이득  자본 손실  주당 시간              모국 주당 시간2  \n",
       "0         Male   2174      0     40   United-States     Mw  \n",
       "1         Male      0      0     13   United-States     Lw  \n",
       "2         Male      0      0     40   United-States     Mw  \n",
       "3         Male      0      0     40   United-States     Mw  \n",
       "4       Female      0      0     40            Cuba     Mw  \n",
       "...        ...    ...    ...    ...             ...    ...  \n",
       "32556   Female      0      0     38   United-States     Mw  \n",
       "32557     Male      0      0     40   United-States     Mw  \n",
       "32558   Female      0      0     40   United-States     Mw  \n",
       "32559     Male      0      0     20   United-States     Lw  \n",
       "32560   Female  15024      0     40   United-States     Mw  \n",
       "\n",
       "[32561 rows x 16 columns]"
      ]
     },
     "execution_count": 253,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf['주당 시간2']='a'\n",
    "mdf.loc[mdf['주당 시간']<=30,'주당 시간2']='Lw'\n",
    "mdf.loc[(mdf['주당 시간']>30)&(mdf['주당 시간']<=60),'주당 시간2']='Mw'\n",
    "mdf.loc[(mdf['주당 시간']>60)&(mdf['주당 시간']<=90),'주당 시간2']='Hw'\n",
    "mdf.loc[mdf['주당 시간']>90,'주당 시간2']='Vhw'\n",
    "mdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 254,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0          Never-married\n",
       "1     Married-civ-spouse\n",
       "2               Divorced\n",
       "3     Married-civ-spouse\n",
       "4     Married-civ-spouse\n",
       "Name: 혼인 상태, dtype: object"
      ]
     },
     "execution_count": 254,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf['혼인 상태'].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 255,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       " Married-civ-spouse       14976\n",
       " Never-married            10683\n",
       " Divorced                  4443\n",
       " Separated                 1025\n",
       " Widowed                    993\n",
       " Married-spouse-absent      418\n",
       " Married-AF-spouse           23\n",
       "Name: 혼인 상태, dtype: int64"
      ]
     },
     "execution_count": 255,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf['혼인 상태'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 256,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "mdf.loc[(mdf['혼인 상태'] == ' Never-married'), '혼인 상태2'] = 'Ma1'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 257,
   "metadata": {},
   "outputs": [],
   "source": [
    "mdf.loc[(mdf['혼인 상태'] == ' Married-civ-spouse') |\n",
    "        (mdf['혼인 상태'] == ' Married-spouse-absent') |\n",
    "        (mdf['혼인 상태'] == ' Married-AF-spouse'), '혼인 상태2'] = 'Ma2'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 258,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>성별</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>2174</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>Male</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>Female</td>\n",
       "      <td>15024</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 17 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black   \n",
       "...                    ...                 ...             ...     ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White   \n",
       "32559        Never-married        Adm-clerical       Own-child   White   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White   \n",
       "\n",
       "            성별  자본 이득  자본 손실  주당 시간              모국 주당 시간2 혼인 상태2  \n",
       "0         Male   2174      0     40   United-States     Mw    Ma1  \n",
       "1         Male      0      0     13   United-States     Lw    Ma2  \n",
       "2         Male      0      0     40   United-States     Mw    Ma3  \n",
       "3         Male      0      0     40   United-States     Mw    Ma2  \n",
       "4       Female      0      0     40            Cuba     Mw    Ma2  \n",
       "...        ...    ...    ...    ...             ...    ...    ...  \n",
       "32556   Female      0      0     38   United-States     Mw    Ma2  \n",
       "32557     Male      0      0     40   United-States     Mw    Ma2  \n",
       "32558   Female      0      0     40   United-States     Mw    Ma3  \n",
       "32559     Male      0      0     20   United-States     Lw    Ma1  \n",
       "32560   Female  15024      0     40   United-States     Mw    Ma2  \n",
       "\n",
       "[32561 rows x 17 columns]"
      ]
     },
     "execution_count": 258,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf.loc[(mdf['혼인 상태'] == ' Divorced') |\n",
    "        (mdf['혼인 상태'] == ' Separated') |\n",
    "        (mdf['혼인 상태'] == ' Widowed'), '혼인 상태2'] = 'Ma3'\n",
    "mdf"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "'''mdf.loc[(mdf['관계'] == ' Husband')|\n",
    "           (mdf['관계']==' Wife')|\n",
    "           (mdf['관계']==' Own-child'),'관계2'] = 0\n",
    "mdf.loc[(mdf['관계'] == ' Not-in-family')|\n",
    "           (mdf['관계'] == ' Unmarried'),'관계2']=1\n",
    "mdf.loc[(mdf['관계']==' Other-relative'),'관계2']=2\n",
    "mdf'''"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 259,
   "metadata": {},
   "outputs": [],
   "source": [
    "mdf.loc[(mdf.인종 ==' Other')|\n",
    "                   (mdf.인종 ==' Amer-Indian-Eskimo')|\n",
    "                   (mdf.인종 ==' Asian-Pac-Islander')|\n",
    "                   (mdf.인종 ==' Black'), 'Not_white'] = 1\n",
    "mdf.loc[(mdf.인종 ==' White'), 'Not_white'] = 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 260,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Hw  Lw  Mw  Vhw\n",
       "0   0   0   1    0\n",
       "1   0   1   0    0\n",
       "2   0   0   1    0\n",
       "3   0   0   1    0\n",
       "4   0   0   1    0"
      ]
     },
     "execution_count": 260,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf_n2 = pd.get_dummies(mdf['주당 시간2'])\n",
    "mdf_n2.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 261,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  ...  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White  ...   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White  ...   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White  ...   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black  ...   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black  ...   \n",
       "...                    ...                 ...             ...     ...  ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White  ...   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White  ...   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White  ...   \n",
       "32559        Never-married        Adm-clerical       Own-child   White  ...   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White  ...   \n",
       "\n",
       "      자본 손실  주당 시간              모국  주당 시간2 혼인 상태2 Not_white Hw  Lw  Mw  Vhw  \n",
       "0         0     40   United-States      Mw    Ma1       0.0  0   0   1    0  \n",
       "1         0     13   United-States      Lw    Ma2       0.0  0   1   0    0  \n",
       "2         0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "3         0     40   United-States      Mw    Ma2       1.0  0   0   1    0  \n",
       "4         0     40            Cuba      Mw    Ma2       1.0  0   0   1    0  \n",
       "...     ...    ...             ...     ...    ...       ... ..  ..  ..  ...  \n",
       "32556     0     38   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32557     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32558     0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "32559     0     20   United-States      Lw    Ma1       0.0  0   1   0    0  \n",
       "32560     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "\n",
       "[32561 rows x 22 columns]"
      ]
     },
     "execution_count": 261,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf = pd.concat([mdf, mdf_n2], axis=1)\n",
    "mdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 262,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  ...  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White  ...   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White  ...   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White  ...   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black  ...   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black  ...   \n",
       "...                    ...                 ...             ...     ...  ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White  ...   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White  ...   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White  ...   \n",
       "32559        Never-married        Adm-clerical       Own-child   White  ...   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White  ...   \n",
       "\n",
       "      자본 손실  주당 시간              모국  주당 시간2 혼인 상태2 Not_white Hw  Lw  Mw  Vhw  \n",
       "0         0     40   United-States      Mw    Ma1       0.0  0   0   1    0  \n",
       "1         0     13   United-States      Lw    Ma2       0.0  0   1   0    0  \n",
       "2         0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "3         0     40   United-States      Mw    Ma2       1.0  0   0   1    0  \n",
       "4         0     40            Cuba      Mw    Ma2       1.0  0   0   1    0  \n",
       "...     ...    ...             ...     ...    ...       ... ..  ..  ..  ...  \n",
       "32556     0     38   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32557     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32558     0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "32559     0     20   United-States      Lw    Ma1       0.0  0   1   0    0  \n",
       "32560     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "\n",
       "[32561 rows x 22 columns]"
      ]
     },
     "execution_count": 262,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 263,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>학력</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>모국</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>State-gov</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Private</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Private</td>\n",
       "      <td>11th</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Private</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>Cuba</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>Private</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>Private</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>Private</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>Private</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                   노동 계급           학력                혼인 상태  \\\n",
       "0              State-gov    Bachelors        Never-married   \n",
       "1       Self-emp-not-inc    Bachelors   Married-civ-spouse   \n",
       "2                Private      HS-grad             Divorced   \n",
       "3                Private         11th   Married-civ-spouse   \n",
       "4                Private    Bachelors   Married-civ-spouse   \n",
       "...                  ...          ...                  ...   \n",
       "32556            Private   Assoc-acdm   Married-civ-spouse   \n",
       "32557            Private      HS-grad   Married-civ-spouse   \n",
       "32558            Private      HS-grad              Widowed   \n",
       "32559            Private      HS-grad        Never-married   \n",
       "32560       Self-emp-inc      HS-grad   Married-civ-spouse   \n",
       "\n",
       "                       직업              관계      인종              모국  \n",
       "0            Adm-clerical   Not-in-family   White   United-States  \n",
       "1         Exec-managerial         Husband   White   United-States  \n",
       "2       Handlers-cleaners   Not-in-family   White   United-States  \n",
       "3       Handlers-cleaners         Husband   Black   United-States  \n",
       "4          Prof-specialty            Wife   Black            Cuba  \n",
       "...                   ...             ...     ...             ...  \n",
       "32556        Tech-support            Wife   White   United-States  \n",
       "32557   Machine-op-inspct         Husband   White   United-States  \n",
       "32558        Adm-clerical       Unmarried   White   United-States  \n",
       "32559        Adm-clerical       Own-child   White   United-States  \n",
       "32560     Exec-managerial            Wife   White   United-States  \n",
       "\n",
       "[32561 rows x 7 columns]"
      ]
     },
     "execution_count": 263,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf[con]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#Hi_Ac = \n",
    "\n",
    "mdf.loc[(mdf['학력'] == 0)|\n",
    "          (mdf['학력'] == 1)|\n",
    "          (mdf['학력'] ==2)|\n",
    "          (mdf['학력'] ==3)|\n",
    "          (mdf['학력'] ==4)|\n",
    "          (mdf['학력'] ==5)|\n",
    "          (mdf['학력'] ==6)|\n",
    "          (mdf['학력'] ==7)|\n",
    "          (mdf['학력'] ==11)|\n",
    "           (mdf['학력']==13),'Hi_Ac'] = 0\n",
    "mdf.loc[(mdf['학력'] == 10)|\n",
    "          (mdf['학력'] == 14)|\n",
    "          (mdf['학력'] ==15)|\n",
    "          (mdf['학력'] == 12)|\n",
    "          (mdf['학력'] == 8)|\n",
    "          (mdf['학력'] ==9),'Hi_Ac'] = 1\n",
    "#Lo_Ac = "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "mdf.loc[(mdf['학력'] !=10)|\n",
    "           (mdf['학력'] !=9)|\n",
    "           (mdf['학력'] !=12),'Master'] = 0\n",
    "\n",
    "mdf.loc[(mdf['학력'] ==10)|\n",
    "           (mdf['학력'] ==9)|\n",
    "           (mdf['학력'] ==12),'Master'] = 1\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 264,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "아이디             0\n",
       "나이              0\n",
       "노동 계급        1836\n",
       "fnlwgt          0\n",
       "학력              0\n",
       "교육 수            0\n",
       "혼인 상태           0\n",
       "직업           1843\n",
       "관계              0\n",
       "인종              0\n",
       "성별              0\n",
       "자본 이득           0\n",
       "자본 손실           0\n",
       "주당 시간           0\n",
       "모국            583\n",
       "주당 시간2          0\n",
       "혼인 상태2          0\n",
       "Not_white       0\n",
       "Hw              0\n",
       "Lw              0\n",
       "Mw              0\n",
       "Vhw             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 264,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 265,
   "metadata": {},
   "outputs": [],
   "source": [
    "imputer_con = SimpleImputer(strategy=\"most_frequent\")  \n",
    "con = ['노동 계급', '학력', '혼인 상태', '직업', '관계', '인종', '모국']\n",
    "mdf[con]=imputer_con.fit_transform(mdf[con])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 269,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>State-gov</td>\n",
       "      <td>77516</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>Self-emp-not-inc</td>\n",
       "      <td>83311</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>215646</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Divorced</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>Private</td>\n",
       "      <td>234721</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Handlers-cleaners</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>Private</td>\n",
       "      <td>338409</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Prof-specialty</td>\n",
       "      <td>Wife</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>Cuba</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>H52557</td>\n",
       "      <td>27</td>\n",
       "      <td>Private</td>\n",
       "      <td>257302</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Tech-support</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>H52558</td>\n",
       "      <td>40</td>\n",
       "      <td>Private</td>\n",
       "      <td>154374</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>H52559</td>\n",
       "      <td>58</td>\n",
       "      <td>Private</td>\n",
       "      <td>151910</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Widowed</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Unmarried</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma3</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>H52560</td>\n",
       "      <td>22</td>\n",
       "      <td>Private</td>\n",
       "      <td>201490</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Adm-clerical</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>20</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>H52561</td>\n",
       "      <td>52</td>\n",
       "      <td>Self-emp-inc</td>\n",
       "      <td>287927</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Wife</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이              노동 계급  fnlwgt           학력  교육 수  \\\n",
       "0      H20001  39          State-gov   77516    Bachelors    13   \n",
       "1      H20002  50   Self-emp-not-inc   83311    Bachelors    13   \n",
       "2      H20003  38            Private  215646      HS-grad     9   \n",
       "3      H20004  53            Private  234721         11th     7   \n",
       "4      H20005  28            Private  338409    Bachelors    13   \n",
       "...       ...  ..                ...     ...          ...   ...   \n",
       "32556  H52557  27            Private  257302   Assoc-acdm    12   \n",
       "32557  H52558  40            Private  154374      HS-grad     9   \n",
       "32558  H52559  58            Private  151910      HS-grad     9   \n",
       "32559  H52560  22            Private  201490      HS-grad     9   \n",
       "32560  H52561  52       Self-emp-inc  287927      HS-grad     9   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  ...  \\\n",
       "0            Never-married        Adm-clerical   Not-in-family   White  ...   \n",
       "1       Married-civ-spouse     Exec-managerial         Husband   White  ...   \n",
       "2                 Divorced   Handlers-cleaners   Not-in-family   White  ...   \n",
       "3       Married-civ-spouse   Handlers-cleaners         Husband   Black  ...   \n",
       "4       Married-civ-spouse      Prof-specialty            Wife   Black  ...   \n",
       "...                    ...                 ...             ...     ...  ...   \n",
       "32556   Married-civ-spouse        Tech-support            Wife   White  ...   \n",
       "32557   Married-civ-spouse   Machine-op-inspct         Husband   White  ...   \n",
       "32558              Widowed        Adm-clerical       Unmarried   White  ...   \n",
       "32559        Never-married        Adm-clerical       Own-child   White  ...   \n",
       "32560   Married-civ-spouse     Exec-managerial            Wife   White  ...   \n",
       "\n",
       "      자본 손실  주당 시간              모국  주당 시간2 혼인 상태2 Not_white Hw  Lw  Mw  Vhw  \n",
       "0         0     40   United-States      Mw    Ma1       0.0  0   0   1    0  \n",
       "1         0     13   United-States      Lw    Ma2       0.0  0   1   0    0  \n",
       "2         0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "3         0     40   United-States      Mw    Ma2       1.0  0   0   1    0  \n",
       "4         0     40            Cuba      Mw    Ma2       1.0  0   0   1    0  \n",
       "...     ...    ...             ...     ...    ...       ... ..  ..  ..  ...  \n",
       "32556     0     38   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32557     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "32558     0     40   United-States      Mw    Ma3       0.0  0   0   1    0  \n",
       "32559     0     20   United-States      Lw    Ma1       0.0  0   1   0    0  \n",
       "32560     0     40   United-States      Mw    Ma2       0.0  0   0   1    0  \n",
       "\n",
       "[32561 rows x 22 columns]"
      ]
     },
     "execution_count": 269,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "metadata": {},
   "outputs": [],
   "source": [
    "obj = ['노동 계급', '학력', '혼인 상태', '직업', '관계', '인종', '성별', '모국','주당 시간2', '혼인 상태2']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 287,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>6</td>\n",
       "      <td>77516</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>5</td>\n",
       "      <td>83311</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>38</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>3</td>\n",
       "      <td>215646</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>3</td>\n",
       "      <td>234721</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>3</td>\n",
       "      <td>338409</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이  노동 계급  fnlwgt  학력  교육 수  혼인 상태  직업  관계  인종  ...  자본 손실  주당 시간  \\\n",
       "0  H20001  39      6   77516   9    13      4   0   1   4  ...      0     40   \n",
       "1  H20002  50      5   83311   9    13      2   3   0   4  ...      0     13   \n",
       "2  H20003  38      3  215646  11     9      0   5   1   4  ...      0     40   \n",
       "3  H20004  53      3  234721   1     7      2   5   0   2  ...      0     40   \n",
       "4  H20005  28      3  338409   9    13      2   9   5   2  ...      0     40   \n",
       "\n",
       "   모국  주당 시간2  혼인 상태2  Not_white  Hw  Lw  Mw  Vhw  \n",
       "0  38       2       0        0.0   0   0   1    0  \n",
       "1  38       1       1        0.0   0   1   0    0  \n",
       "2  38       2       2        0.0   0   0   1    0  \n",
       "3  38       2       1        1.0   0   0   1    0  \n",
       "4   4       2       1        1.0   0   0   1    0  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 287,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf[obj] = mdf[obj].apply(lambda x: x.astype('category').cat.codes)\n",
    "mdf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 288,
   "metadata": {},
   "outputs": [],
   "source": [
    "corr=mdf.corr()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 289,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "성별           1.000000\n",
       "관계           0.582454\n",
       "주당 시간        0.229309\n",
       "Lw           0.175432\n",
       "Mw           0.130406\n",
       "혼인 상태        0.129314\n",
       "Not_white    0.103486\n",
       "나이           0.088832\n",
       "인종           0.087204\n",
       "주당 시간2       0.086439\n",
       "노동 계급        0.071584\n",
       "혼인 상태2       0.069268\n",
       "Hw           0.067643\n",
       "자본 이득        0.048480\n",
       "직업           0.047461\n",
       "자본 손실        0.045567\n",
       "학력           0.027356\n",
       "fnlwgt       0.026858\n",
       "Vhw          0.019560\n",
       "교육 수         0.012280\n",
       "모국           0.002061\n",
       "Name: 성별, dtype: float64"
      ]
     },
     "execution_count": 289,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "corr.성별.abs().sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 290,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "성별           1.000000\n",
       "관계           0.582454\n",
       "주당 시간        0.229309\n",
       "Lw           0.175432\n",
       "Mw           0.130406\n",
       "혼인 상태        0.129314\n",
       "Not_white    0.103486\n",
       "나이           0.088832\n",
       "인종           0.087204\n",
       "주당 시간2       0.086439\n",
       "노동 계급        0.071584\n",
       "혼인 상태2       0.069268\n",
       "Hw           0.067643\n",
       "자본 이득        0.048480\n",
       "직업           0.047461\n",
       "자본 손실        0.045567\n",
       "학력           0.027356\n",
       "fnlwgt       0.026858\n",
       "Vhw          0.019560\n",
       "교육 수         0.012280\n",
       "모국           0.002061\n",
       "Name: 성별, dtype: float64"
      ]
     },
     "execution_count": 290,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "corr=mdf.corr()\n",
    "corr.성별.abs().sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 291,
   "metadata": {},
   "outputs": [],
   "source": [
    "mdfS=mdf.set_index('아이디')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 292,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split  \n",
    "\n",
    "X = mdfS.drop(['성별'], axis=1) \n",
    "Y = mdfS['성별']                    \n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.3, random_state=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "https://greeksharifa.github.io/machine_learning/2019/12/09/Light-GBM/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 293,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MinMaxScaler()"
      ]
     },
     "execution_count": 293,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "scaler = MinMaxScaler()\n",
    "scaler.fit(mdfS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 294,
   "metadata": {},
   "outputs": [],
   "source": [
    "x = scaler.transform(mdfS)\n",
    "mdfS = pd.DataFrame(x, columns=mdfS.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 295,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H20001</td>\n",
       "      <td>39</td>\n",
       "      <td>6</td>\n",
       "      <td>77516</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H20002</td>\n",
       "      <td>50</td>\n",
       "      <td>5</td>\n",
       "      <td>83311</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>38</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H20003</td>\n",
       "      <td>38</td>\n",
       "      <td>3</td>\n",
       "      <td>215646</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>5</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H20004</td>\n",
       "      <td>53</td>\n",
       "      <td>3</td>\n",
       "      <td>234721</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H20005</td>\n",
       "      <td>28</td>\n",
       "      <td>3</td>\n",
       "      <td>338409</td>\n",
       "      <td>9</td>\n",
       "      <td>13</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>5</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 22 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이  노동 계급  fnlwgt  학력  교육 수  혼인 상태  직업  관계  인종  ...  자본 손실  주당 시간  \\\n",
       "0  H20001  39      6   77516   9    13      4   0   1   4  ...      0     40   \n",
       "1  H20002  50      5   83311   9    13      2   3   0   4  ...      0     13   \n",
       "2  H20003  38      3  215646  11     9      0   5   1   4  ...      0     40   \n",
       "3  H20004  53      3  234721   1     7      2   5   0   2  ...      0     40   \n",
       "4  H20005  28      3  338409   9    13      2   9   5   2  ...      0     40   \n",
       "\n",
       "   모국  주당 시간2  혼인 상태2  Not_white  Hw  Lw  Mw  Vhw  \n",
       "0  38       2       0        0.0   0   0   1    0  \n",
       "1  38       1       1        0.0   0   1   0    0  \n",
       "2  38       2       2        0.0   0   0   1    0  \n",
       "3  38       2       1        1.0   0   0   1    0  \n",
       "4   4       2       1        1.0   0   0   1    0  \n",
       "\n",
       "[5 rows x 22 columns]"
      ]
     },
     "execution_count": 295,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 296,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "나이           0\n",
       "노동 계급        0\n",
       "fnlwgt       0\n",
       "학력           0\n",
       "교육 수         0\n",
       "혼인 상태        0\n",
       "직업           0\n",
       "관계           0\n",
       "인종           0\n",
       "성별           0\n",
       "자본 이득        0\n",
       "자본 손실        0\n",
       "주당 시간        0\n",
       "모국           0\n",
       "주당 시간2       0\n",
       "혼인 상태2       0\n",
       "Not_white    0\n",
       "Hw           0\n",
       "Lw           0\n",
       "Mw           0\n",
       "Vhw          0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 296,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdfS.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.feature_selection import SelectFromModel\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.feature_selection import SelectKBest"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import VotingClassifier\n",
    "from sklearn.linear_model import LogisticRegression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split  \n",
    "\n",
    "X = mdf.drop(['아이디','성별'], axis=1) \n",
    "Y = mdf['성별']                    \n",
    "\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.3, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.tree import DecisionTreeClassifier\n",
    "tree = DecisionTreeClassifier(max_depth=9, random_state=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "DecisionTreeClassifier(max_depth=9, random_state=0)"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tree.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8303818200429931"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "display(tree.score(X_test, y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "findfont: Font family ['Nanum Gothic'] not found. Falling back to DejaVu Sans.\n",
      "findfont: Font family ['Nanum Gothic'] not found. Falling back to DejaVu Sans.\n"
     ]
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYoAAAEWCAYAAAB42tAoAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8vihELAAAACXBIWXMAAAsTAAALEwEAmpwYAABAqklEQVR4nO3dd3xUZdbA8d9JQkilhtCbNKlJILTQQbqggAgqsgqIioCA7lrQBUV31bW/CygCAsqKSg1FBAERCSAdpHcINYBACiHtef+YIYQQkgEymZLz3c0nc+ucuZJ75nmee88VYwxKKaXU7Xg4OgCllFLOTROFUkqpbGmiUEoplS1NFEoppbKliUIppVS2NFEopZTKliYKpZRS2dJEodyOiBwVkasiEiciZ0RkmogEZFonQkRWikisiFwWkYUiUivTOoVE5FMROW7d10HrdFDefiKlHEsThXJX3YwxAUAoEAa8dn2BiDQFlgELgDJAZWA7sFZE7rOu4w2sAGoDnYBCQARwAWhkr6BFxMte+1bqbmmiUG7NGHMG+BlLwrjuA2CGMeYzY0ysMeaiMeYNYD0w1rpOf6AC0MMYs9sYk2aMOWeMGWeMWZLVe4lIbRFZLiIXReSsiLxunT9NRN7JsF5rEYnOMH1URF4RkR1AvIi8ISKzM+37MxH53Pq6sIhMEZHTInJSRN4REc97O1JK3Z4mCuXWRKQc0Bk4aJ32w9Iy+DGL1X8A2ltfPwAsNcbE2fg+gcAvwFIsrZSqWFoktnoM6AoUAb4BuohIIeu+PYFHgf9Z150OpFjfIwzoAAy6g/dS6o5oolDuar6IxAIngHPAGOv8Ylj+3Z/OYpvTwPXxh+K3Wed2HgTOGGM+MsYkWlsqG+5g+8+NMSeMMVeNMceALcDD1mVtgQRjzHoRKYkl8Y0wxsQbY84BnwB97+C9lLojmiiUu3rYGBMItAbu50YC+AtIA0pnsU1p4Lz19YXbrHM75YFDdxWpxYlM0//D0soAeJwbrYmKQAHgtIhcEpFLwJdA8D28t1LZ0kSh3JoxZjUwDfjQOh0PrAN6Z7H6o9zoLvoF6Cgi/ja+1Qmgym2WxQN+GaZLZRVqpukfgdbWrrMe3EgUJ4BrQJAxpoj1p5AxpraNcSp1xzRRqPzgU6C9iIRap18F/iYiw0UkUESKWgebmwJvWdf5BstJeY6I3C8iHiJSXEReF5EuWbzHIqCUiIwQkYLW/Ta2LtuGZcyhmIiUAkbkFLAxJgb4FfgaOGKM2WOdfxrLFVsfWS/f9RCRKiLS6g6PiVI200Sh3J71pDsDeNM6/TvQEeiJZRziGJZB4ebGmAPWda5hGdDeCywHrgB/YOnCumXswRgTi2UgvBtwBjgAtLEu/gbL5bdHsZzkv7cx9P9ZY/hfpvn9AW9gN5autNncWTeZUndE9MFFSimlsqMtCqWUUtmyW6IQkakick5E/rzNchGRz61lEXaISH17xaKUUuru2bNFMQ1L6YPb6QxUs/4MBibaMRallFJ3yW6JwhjzG3Axm1UewlJGwRhj1gNFREQH5JRSysk4sgBZWW6+ySjaOu+Wu2FFZDCWVgf+/v4N7r///jwJUCnlWowxpJm0m35umpeWdss6qWmpN/8Yy+80k4bBYPm/Sd//Tb+t/8tqHaeREABXA8CcOW+MKXE3u3BkopAs5mV5hI0xk4BJAOHh4WbTpk32jEspZQfGGBKSEohNjOXK1SvEXrP8jrsWR0JSAvHX4klISrjpJ/5aPHHX4tJ/X02+ytWkq+m/E5MTLa+TLa/v5iQtIgT6BFLYt/BNP74FfPH08LzxI554eHikv74+30M8blovfTqbdWxd76ZpsWFfGdYTBC9PL1YuO8naX88wfUqfY3f7386RiSIaS9mD68oBpxwUi1IqC8YY4q/FW07uiVduOsmnv86w7Jb1Mi1LM2k2v7evty9+3n74e/sTUDAA/4L++Hn7UTygOD5ePvh6++JbwDf9t08Bn1unM6yT1Tb+BS379vBwnwtA//rrKi+/vIz77ivK6NEtqdKvCs/0g+lT+tz1Ph2ZKCKBoSIyC2gMXLbedaqUukdpaWlcSbzCpYRLXL56mctXL3Pl6pUbrxOvpJ/Ibzq5Z0oGcYlxNp3cPcSDQJ9ACvkWIrCg5Xch30KUK1qOQJ9AyzKfQjfWyTB9PQlcTwT+3v74FPBxq5N3Xpk3bw9DhiwhJiaeN95omWv7tVuiEJHvsBRkC7LW3h+DpZgZxpgvgCVAFyzlnxOAp+0Vi1LuKCU1haMXjnLg7AH2n93P/rP7OXDuAIdjDnP84nGSU5Oz3d7Tw/OWE3gR3yJUKFbh1pO79XdWJ/pCPoXw9fZFJKveZJUXzp6NY9iwn/jxx92EhpZi8eLHqV8/964NsluiMMY8lsNyA7xgr/dXyh2kpKZw7MIxDsUc4lDMIQ6eO8iBc5bEcDjm8E3JoLBvYaqXrE54pXAeafAIwYHBFPUvSmHfwhTyKZTe917It5Ce3N3MiRNXWLz4AO++25a//z2CAgVy9zlW+thFpZyAMYazV85y5PwRzl45y6yNs9h0dBPHLh4jJTUlfT2fAj5UC65GnTJ16BnWk2olq1G9ZHWql6xOUECQnvjzkWPHLrFw4X6GDm1EeHgZjh8fQfHifjlveBc0USiVR4wxnI87z74z+yw/Z/ex/+x+DsUc4nDMYRKSEm5av+39benTsA9VSlShSokqVA2uSunCpbXvPp9LSzNMnLiRV1+1VMTv1asmpUsH2i1JgCYKpXJVYnIiZ6+c5czlM5y5csby+/IZDp8/zOKdi7kQdyF9XW8vb6qWqErV4Ko8UPMBqpSoQuWgypQuXJpShUtRpkgZB34S5Yz27TvPoEEL+f3343TsWIUvv3yQ0qUD7f6+miiUukOxibH8ceQPog5Fsf3Edi7EX0hPDJcSLmW5TfGA4oRXDKdTnU7UKFmDGqVqULF4RTw9crcvWbmvhIRkmjf/mtTUNKZNe4j+/UPyrKtRE4VS2TDGcDjmMOsOryPqUBRRB6PYeXInaSYNEaFqiaqULFSSOmXr8EDNByhVuBSlCpWy/La+Dg4MpoBXAUd/FOWi9u+/QLVqxfDzK8A33/QgNLQUpUoF5GkMmiiUyuBq0lU2H9tM1KEo1h2yJIdzsecACPQJpMl9TXgz7E0iqkTQuHJjCvsVdnDEyl0lJqYwbtxq3n9/LdOmPUy/fvXo1KmqQ2LRRKHyteiL0TdaC4ei2Hp8a/olp9WCq9GpTiciqkQQUSWCWmVqaVeRyhNr1x5n4MBI9u27wNNPh9K1azWHxqOJQuUbySnJbDux7abEcOKipS6lTwEfGlVuxEsdXqLpfU1pWqUpJQLvqn6aUvdk3LjVjBnzKxUqFObnn/vRoUMVR4ekiUK5r5jYmPTuo3WH17Hx6EauJl0FoEKxCpaWQgdLayGkXIiOIyiHMsYgIoSGlmLYsEa8+247AgK8HR0W4ILPzNbqsSorqWmp7D61O72lEHUoioPnDgJQwLMA9SvUp2mVpkRUiaDpfU0pV6ycgyNWyuLixauMHPkzVasW5c03W9ntfURkszEm/G621RaFckmXEy6z/vD69G6k9YfXE5sYC0BwYDARVSIY3HIwTe9rSoOKDfD19nVwxErdavbs3bzwwhIuXrzKm2/mXhG/3KaJQrmE5JRkdpzcwezNs1m0YxG7Tu3CGIOHeFCvXD36NemXPuhcOaiylrJQTu306ViGDv2JuXP30KBBaZYt60dISClHh3VbmiiUUzDGcOLiCbae2Mre03s5dflUegnsU5dOseX4FhKTExER2tdsz6PhjxJRJYJGlRsR6GP/O1OVyk2nTsXy888Hef/9Bxg1qileXs5dlkUThcpzySnJ7D69m20ntt30k/Gu5utPHCvkU4igwCCeb/U8je9rTESVCMoXK3/7nSvlpI4evcTChfsYNqwxDRqU4cSJkRQt6hpdopooVJ6IS4xj6a6lzN86n0U7FnH56mXA8hSzemXr0Se8D6HlQwktH0qtMrUo5FvIwRErlTtSU9MYP34jr7++Ag8PoXfv2pQqFeAySQI0USg7iomNYeH2hczbOo/lu5dzLeUaxQOK07N+T9rXbE9YhTCqlaymN7Ept7VnTwyDBi0kKuoEnTpV5csvH8zz8hu5QROFylUnLp5g7pa5zN06l98P/E6aSaNi8Yo81+o5eoT1oFnVZnh56j875f4SEpJp2XIaaWmGGTMsJThc9SIL/YtV9+zguYPM2TyHOVvmsPHoRgDqlK3D6K6j6RHWg9DyoS77B6LUndq79zw1ahTHz68AM2f2JCSkJCVLul4rIiNNFOqOGWPYdWoXczbPYe7WueyI3gFAeMVw/t3z3/QM60n1UtUdHKVSeevq1WTGjv2VDz9cx/TplhaEM5TfyA2aKJRNjDFsPraZOVvmMHfLXPaf3Y+I0KxKMz7p8wk9wnpQsXhFR4eplEP89tsxBg2K5MCBiwwaFMaDD7rXFyVNFOq2UtNSWXdoXXpyOH7xOJ4enrSp0YaRD4zkodCHKF2ktKPDVMqh3nrrV8aOXU3lykX45ZcnadfuPkeHlOs0UaibJKcks3r/auZsmcP8bfM5c/kM3l7edKjVgbe6v0W3kG4UDyju6DCVcrjrRfzCw8swcmQTxo1rg7+/cxTxy22aKBTXkq+xfPdy5myZQ+T2SC7GX8TP248udbvQq34vutTtovc1KGV1/nwCI0f+TLVqxfjnP1vRtWt1unZ1r66mzDRR5FPx1+L56c+fmLN5Dot3LiY2MZbCvoXpFtKNnmE96Vi7I34F/RwdplJOwxjDjz/uZujQJfz1VyJjxtiv0quz0USRj1xKuMSiHYuYs3kOS3ctJTE5kaCAIPo07EOv+r1oe39bvL3cs+ms1L04dSqWIUMWs2DBPsLDy/DLL92pV6+ko8PKM5oo3FxMbAwLti1gzpY5rNizguTUZMoUKcOg5oPoWb8nLaq10BvglMrBmTNxrFx5hP/8pz0jRjRx+iJ+uU3PEG7GGMOxC8csLYctc/ht/2+kmTQqB1XmxXYv0rN+TxpXboyHR/76h67UnTp8+C8iI/cxYkQT6tcvzfHjIylSxMfRYTmEJgoXd/050GsPrSXqoOXJbicvnQSgZumavN7ldXrW76l3Rytlo9TUND7/fAOjR6+kQAFP+vatQ6lSAfk2SYAmCpdzIe5C+nOg1x5ae9NzoCsWr0jL6i2JqBJBu5rtqFm6poOjVcq17Np1joEDI9mw4SRdu1bjiy9cs4hfbtNE4cSMMew7s8+SFA6uJepQFHvP7AXAy9OLsPJhDG4xmGZVm+lzoJW6RwkJybRqNQ0R4X//60nfvnW0FW6licKJXIi7wPYT29lwZANRhyzdSBfjLwJQ1K8oEVUi6N+0PxFVImhYqaFevqpULti9O4aaNYPw8yvArFmPEBJSkhIl/B0dllPRROFgf8X/xcq9K5m1cRbzt80nJTUFgBqlavBw6MNEVImgWdVmVC9ZXQeglcpFCQnJjBmzio8/Xs+0aQ/x5JMhPPCA+5XfyA2aKPLY2Stn2XZ8G1GHoli2exl/HPmDNJNGYd/CjGg3gg61OxBWPoygwCBHh6qU2/r116M888xCDh68yLPPNqB79xqODsmpaaLIA8YY1hxYw/hV45m7dS4pqSl4iAeNKjfija5v0KF2BxpVakQBrwKODlUptzdmzCrefvs3qlQpysqV/WnTprKjQ3J6mijsKC4xjpkbZjJ+1Xh2ntxJEb8iDG87nO4h3alXrh5F/Ys6OkSl8o3rRfwaNSrLSy815e232+Dnp1/ObGHXRCEinYDPAE9gsjHmvUzLCwPfAhWssXxojPnanjHlhcMxhxm/ajxTfp/C5auXCSkXwlf9v+LxRo/rALRSeSwmJp4XX1xKjRrFGTOmdb4o4pfb7JYoRMQTGA+0B6KBjSISaYzZnWG1F4DdxphuIlIC2CciM40xSfaKy16MMazcu5LPV3zOwh0L8fTwpFf9XgxrO4yIKhF6mZ1SecwYw3ff/cnw4T9x5co13nqrtaNDcln2bFE0Ag4aYw4DiMgs4CEgY6IwQKBYzqIBwEUgxY4x5br4a/HM3DCTz1d8zq5TuygRWILRXUbzXKvnKFu0rKPDUypfio6+wvPPL2bRov00blyWKVO6U7t2sKPDcln2TBRlgRMZpqOBxpnW+S8QCZwCAoE+xpi0zDsSkcHAYIAKFSrYJdg7YYxh7cG1TF07lR82/UD8tXjCKoTx9VNf07dRX3wK5N9b/ZVyBjEx8fz22zE+/rgDw4c3xtNTLy2/F/ZMFFn1tZhM0x2BbUBboAqwXETWGGOu3LSRMZOASQDh4eGZ95Fnzlw+w4x1M5i6dir7zuwjoGAAfRv25elmT2v3klIOdvDgRRYu3MfIkU0JCyvNiRMjKVSooKPDcgv2TBTRQPkM0+WwtBwyehp4zxhjgIMicgS4H/jDjnHdkZTUFH768yem/D6FRTsWkZqWSrOqzXjlqVfo3aA3AT5aB0YpR0pJSePTT9fz5purKFjQk8cfr0vJkgGaJHKRPRPFRqCaiFQGTgJ9gcczrXMcaAesEZGSQA3gsB1jstnBcweZ8vsUpkdN5/Tl0wQHBjOq/SgGNBvA/aXvd3R4Silg586zDBwYycaNp+jevQYTJnShZEn98pbb7JYojDEpIjIU+BnL5bFTjTG7ROQ56/IvgHHANBHZiaWr6hVjzHl7xWSLndE7eXfJu/yw6QcEoUvdLgxsPpCudbvqDXFKOZGEhGTatJmOh4cwa1YvHn20tnb/2olYen1cR3h4uNm0aVOu73fT0U28s/gdFmxbQEDBAIa2HcrQNkP1yiWlnMyff56jdu0SiAgrVhwmJKQUQUF6f1JORGSzMSb8brbN93dmRx2MYtzicSz9cylF/IowptsYhrcbTjH/Yo4OTSmVQXx8Em++uYpPP13P9OkP8+STIbRrp0X88kK+TBQxsTFMWDWBRTsWsenYJoICgvh3z38zpPUQCvkWcnR4SqlMVqw4zDPPLOTIkUsMGRLOQw/pOGFeyneJYvGOxfSd1Jf4pHgaVWrER70/4tlWz+JfUOvPK+WM3nxzJe+8s4Zq1YqxevVTtGxZ0dEh5Tv5JlGkpqUybtE43l70NrXL1OaHZ3/QR4Uq5cTS0gweHkJERHn+8Y8Ixo5tja+vXlDiCPkiUZy5fIYnJj/Byr0r6d+0PxOemKAtCKWc1Llz8Qwf/hM1ahTnrbfa0LlzNTp3rubosPI1t76vPTE5kQ9//pDQt0OJOhTFlL9NYdrT0zRJKOWEjDF8++0OatYcz7x5e7UEuBNx6xbFK3Ne4fMVn1OrdC2Wj1xO3XJ1HR2SUioLJ05c5rnnFrNkyQGaNi3H5MndqVWrhKPDUlZumSiMMXyy/BM+X/E5Q1oP4b+P/1dvxFHKiV24cJW1a4/z2WedeOGFhlrEz8m4ZaKY+vtUXvrxJbqFdOOTPp9oklDKCe3ff4HIyH28/HIEoaGlOHFiJIGBWp/JGbld2t52fBtDvxtK6xqtmfv8XLy9vB0dklIqg5SUNN5//3fq1ZvIu++u4ezZOABNEk7M7VoU4xaPwxjDNwO+wcvT7T6eUi5t+/YzDBgQyZYtp+nR437Gj9cifq7Arc6kV65eYfGOxTzb6lnKFSvn6HCUUhkkJCTTrt0MvLw8mD27N7161XJ0SMpGbpUoIrdHci3lGn3C+zg6FKWU1Y4dZ6lbNxg/vwL8+GNvQkJKUayYr6PDUnfArcYoZv0xiwrFKtDkviaODkWpfC8uLokXX/yJ0NAv+OabHQC0aVNZk4QLcpsWxcX4iyzbvYwRD4zAw8Ot8p9SLmf58kMMHryIo0cvMXRoQ3r00CJ+rsxtEsW8LfNITk2mT0PtdlLKkUaPXsG//vU7NWoUZ82ap2nevIKjQ1L3yG0SxfebvqdqcFXqV6jv6FCUypeuF/Fr3rwCr73WnH/+sxU+Pm5zisnX3KKP5tyVc6zYs4I+4X305jql8tiZM3E88sgPjB37KwCdO1fjX/9qp0nCjbhFopi9eTZpJo2+jfo6OhSl8g1jDNOmbaNWrfEsWrSfQoX0hjl35RYp//tN31OrdC3qlK3j6FCUyheOHbvE4MGLWLbsEM2bV2Dy5G7UqBHk6LCUnbh8iyImNoY1B9boILZSeejSpUQ2bjzJf//bmdWrn9Ik4eZcvkXxx5E/MMbQukZrR4eilFvbt+88kZH7+PvfmxESUorjx0cSEKC11PIDl29RbDy6EQ/x0KudlLKT5ORU/v3vNYSEfMF7763l3Ll4AE0S+YhbtChqlq5JgI8WFlMqt23depqBAyPZuvUMjzxSi//+tzPBwfqEyPzGpRNFbGIsy/cs5/lWzzs6FKXcTkJCMu3bf0OBAp7MmfMoPXvWdHRIykFcOlFsPraZlNQUOtfp7OhQlHIbW7eeJjS0FH5+BZg9+1FCQkpStKjWZ8rPXHqMYuPRjQA0rNTQwZEo5fpiY68xdOgS6teflF7Er3XrSpoklGu3KDYe2Uil4pUICtRL85S6F0uXHuTZZxdx4sRlXnyxsXYzqZu4dKL44+gfNKrUyNFhKOXSXnvtF957by01awaxdu0AmjYt7+iQlJNx2UQRExvDsQvHGNpmqKNDUcolpaam4enpQevWlfDy8uCNN1pSsKDLnhKUHbnsvwodn1Dq7pw+HcsLLyyhdu0SjBvXlo4dq9KxY1VHh6WcmMsOZm88shERoX5FvdFOKVsYY/j6663UqjWBn346qIPUymY2tShExAMIAcoAV4Fdxpiz9gwsJxuPbqRmqZoE+gQ6MgylXMLRo5d45pmF/PLLYVq0qMDkyd2pXr24o8NSLiLbRCEiVYBXgAeAA0AM4ANUF5EE4EtgujEmzd6BZmSMYePRjXr/hFI2unw5kS1bTjNhQheefTYcDw99bouyXU5dT+8A3wJVjDEdjTH9jDGPGGPqAd2BwsCTt9tYRDqJyD4ROSgir95mndYisk1EdonIaluCPh93nnOx5witEGrL6krlS7t3x/Dee78DWIv4jeD55xtqklB3LNsWhTHmsWyWnQM+vd1yEfEExgPtgWhgo4hEGmN2Z1inCDAB6GSMOS4iwbYEfSHuAgDBgTatrlS+kpSUygcfrGXcuN8IDPRmwIAwgoP98ffXIn7q7uTU9dQzu+XGmLnZLG4EHDTGHLbuaxbwELA7wzqPA3ONMcet+ztnS9BXk68CEFBQCwEqldGmTacYODCSHTvO0rdvHT77rJMW8VP3LKfB7G7ZLDNAdomiLHAiw3Q00DjTOtWBAiLyKxAIfGaMmZF5RyIyGBgMUKFCBZJTky3Be7rs1b1K5br4+CQ6dvwWHx8vFizoS/fuNRwdknITOXU9PX0P+86qI9Rk8f4NgHaAL7BORNYbY/ZnimMSMAkgPDzcXE8UBTwL3EN4SrmHLVssRfz8/b2ZN68P9eqVpEgRH0eHpdxITl1Po7Jbboz5OJvF0UDGWgDlgFNZrHPeGBMPxIvIb1guw91PNlJSUwDw8tAWhcq/rly5xquv/sLEiZuYPv1h+vcPoWXLio4OS7mhnM6093KTwkagmohUBk4CfbGMSWS0APiviHgB3li6pj7JacfaolD53ZIlB3j22UWcOhXLqFFN6NVLi/gp+8mp6+mtu92xMSZFRIYCPwOewFRjzC4Rec66/AtjzB4RWQrsANKAycaYP3Pad0qapUWhiULlR6+8spwPPoiiVq0SzJ7dm8aNyzk6JOXmbL0z2wcYCNTGcsMdAMaYAdltZ4xZAizJNO+LTNP/Af5jY7wAOpit8h1jDGlpBk9PD9q1uw8fHy9ef72FFvFTecLWWk/fAKWAjsBqLOMNsfYKKifa9aTyk5Mnr/Dww98zZsyvAHToUIW33mqjSULlGVsTRVVjzJtAvDFmOtAVqGu/sLKng9kqPzDG8NVXm6lVawLLlh0iKMjP0SGpfMrWM22y9fclEakDnAEq2SUiW4LRFoVyc0eO/MXAgZGsWnWU1q0r8dVX3ahatZijw1L5lK2JYpKIFAXeACKBAOCfdosqBzqYrdxdXFwSO3ac5csvH2TQoPpan0k5lE2Jwhgz2fryN+A++4Vjm/TBbO16Um7kzz/PERm5j9dfb0HduiU5fnwkfn76ZUg5nk1jFCLyL2sBv+vTRUXkHbtFlYP0ricv/SNSri8pKZW33vqV+vW/5JNP1nPuXDyAJgnlNGwdzO5sjLl0fcIY8xfQxS4R2UAHs5W72LjxJA0aTGLs2NX07l2b3buHaBE/5XRsPdN6ikhBY8w1ABHxBQraL6zs6WC2cgfx8Ul06jQTX18vIiP70q2bFvFTzsnWRPEtsEJEvsZS2G8AMN1uUeVAB7OVK9u06RT165fG39+bBQv6UrduMIULaxE/5bxs6noyxnyA5Wl3NbHcnT3OOs8hdDBbuaLLlxN59tmFNGz4Fd9+uwOA5s0raJJQTu9OzrR7gBRjzC8i4icigcYYh9ydrSU8lKtZuHAfzz23mDNn4nj55aY88kgtR4eklM1sverpGWA28KV1Vllgvp1iylFKagqeHp6I6LXlyvn9/e/L6N59FsWL+7J+/UD+858OekWTcim2fiV/AcujTTcAGGMO2Pp8a3tITk3W8Qnl1IwxpKYavLw86NChCoUKFeSVV5rj7e3p6NCUumO2Joprxpik69/grc+PyPy0ujyTkpaiiUI5rejoKzz//GLq1Qvm3Xfb0b59Fdq3r+LosJS6a7beR7FaRF4HfEWkPfAjsNB+YWUvOTVZB7KV00lLM3z55SZq1RrPypVHKFUqwNEhKZUrbD3bvgIMAnYCz2J5xsTkbLewI+16Us7m8OG/GDBgAatXH6Ndu8pMmtSN++4r6uiwlMoVOSYKEfEAdhhj6gBf2T+knKWkpegVT8qpxMcnsXt3DJMnd2PAgDC90EK5lRy7nowxacB2EamQB/HYJDlFWxTK8XbuPMs77/wGQN26JTl2bAQDB9bXJKHcjq1fy0sDu0TkDyD++kxjTHe7RJWDlLQUHaNQDnPtWgrvvruGf//7d4oW9WHw4AYEB/vj66tfXpR7svVs+5Zdo7hDOkahHGX9+mgGDoxk9+4YnnyyHp980pHixfXJc8q9ZZsoRESMxeqc1sn90G5PE4VyhPj4JLp2/R/+/gVYsuRxOneu5uiQlMoTOY1RrBKRYZnHJ0TEW0Taish04G/2Cy9rOpit8tKGDdGkpRn8/b1ZuPAxdu0aoklC5Ss5JYpOQCrwnYicEpHdInIYOAA8BnxijJlm5xhvoS0KlRcuXUpk0KBImjSZkl7ELyKiPIGBDquwr5RDZPu13BiTCEwAJohIASAIuJrxIUaOoDfcKXubP38vQ4Ys5ty5eF55pRm9e2sRP5V/2Xy2NcYkA6ftGIvNUlK1hIeyn1GjfuaTT9YTElKShQsfo0GDMo4OSSmHcsmv5cmpyfh565UmKvdkLOLXpUs1ihf35R//aEaBAlrETylbaz05FR3MVrnp+PHLdO36P8aMWQXAAw/cx+jRLTVJKGV1V4lCRDxF5IncDsZWOpitckNammHChI3Urj2B1auPUaZMoKNDUsop5XQfRSEsz6IoC0QCy4GhwMvANmCmnePLkg5mq3t18OBFBgxYwJo1x2nf/j4mTepGpUpFHB2WUk4pp7PtN8BfwDos1WP/DngDDxljttk3tNvTwWx1rxITU9i//wJff/0Qf/tbiNZnUiobOSWK+4wxdQFEZDJwHqjgqGdlX6ddT+pubNt2hgUL9jJmTGvq1Anm6NER+Phoy1SpnOQ0RpF8/YUxJhU44ugkAVoUUN2ZxMQURo9eQXj4JCZO3MS5c5a6lpoklLJNTn8pISJyBbjeLvfNMG2MMYXsGt1tJKcmU8BLWxQqZ1FRJxg4MJK9e8/zt7+F8PHHHSlWzNfRYSnlUnK6M9sprw/UwWxli/j4JLp1+46AAG+WLn2Cjh2rOjokpVxSTlc9+QDPAVWBHcBUY0xKXgSWHR3MVtlZt+4EjRuXw9/fm0WLHqNOnWCtz6TUPchpjGI6EI7lWdldgI/uZOci0klE9onIQRF5NZv1GopIqog8Yst+dTBbZeWvv64yYMACIiKm8s032wFo2lSL+Cl1r3Lqv6mV4aqnKcAftu5YRDyB8UB7IBrYKCKRxpjdWaz3PvCzrfvWwWyV2dy5e3jhhSXExMTz2mvN6dOnjqNDUspt5HS2zXjVU8odXmveCDhojDkMICKzgIeA3ZnWGwbMARraumNtUaiMRo5cyqefbiA0tBRLljxOWFhpR4eklFvJKVGEWq9yAsuVTndy1VNZ4ESG6WigccYVRKQs0ANoSzaJQkQGA4MBKlSoQGpaqtZ6yucyFvF78MHqBAf78/LLEVqfSSk7yGmMYrsxppD1J9AY45XhdU6XxmbV/Mj8yNRPgVes92jcljFmkjEm3BgTHhQUBKAtinzs6NFLdOo0kzffXAlAu3b38dprLTRJKGUnOX0tv5dnYUcD5TNMlwNOZVonHJhl7dIKArqISIoxZv7tA7KEpIki/0lLM4wf/wevvbYCEaFHj/sdHZJS+UJOiSJYREbdbqEx5uNstt0IVBORysBJoC/weKbtK19/LSLTgEXZJQnrNpbAdTA7Xzlw4AJPP72AtWtP0KlTVb74oisVKxZxdFhK5Qs5nW09gQCy7kbKlnXweyiWq5k8sdyDsUtEnrMu/+JO9wnaosivkpJSOXToL2bMeJh+/eppET+l8lBOieK0Mebtu925MWYJsCTTvCwThDHmKRv3CaCD2fnA1q2nWbBgH2PHtqZ27WCOHn2RggX1v7tSeS2nwWyn+9p2PVFoi8J9JSam8Nprv9Cw4Vd8+eVmYmIsRfw0SSjlGDn95bXLkyjugHY9ubfffz/OwIGR7N9/gaefDuWjjzpQtKgW8VPKkXIqCngxrwKxmfU6LB3Mdj9xcUk89NAsChUqyLJl/WjfvoqjQ1JKkXOLwuloi8L9/P77cSIiyhMQ4M3ixY9Tp04wAQHejg5LKWWV0xiF09HBbPdx4UIC/fvPo0WLr9OL+DVpUk6ThFJOxuXOttqicH3GGGbP3s3QoT9x8eJV3nyzJX37ahE/pZyV6yUKverJ5Y0c+TOffbaBBg1Ks2xZP0JCSjk6JKVUNlwvUaB3ZrsiYwwpKWkUKOBJ9+41KFMmkFGjmuLl5XK9n0rlOy73V6otCtdz5MhfdOjwLW++uQqAtm0r849/NNMkoZSLcLm/VB3Mdh2pqWl89tl66tSZyIYN0dx3X1FHh6SUugsud7bVwWzXsH//BZ56aj7r1kXTuXNVvvzyQcqXL+zosJRSd8H1EoV2PbmElJQ0jh27zLff9uDxx+tqET+lXJjrJQodzHZamzadYsGCvYwb15ZatUpw+PBwrc+klBtw2TEKbVE4j6tXk/nHP5bTuPFkpk7dpkX8lHIzLveXnN6i0MFsp7B69VEGDVrIwYMXeeaZ+nzwQXuKFPFxdFhKqVzkcmdbbVE4j7i4JHr2/IEiRXxYsaI/bdtWznkjpZTLcb1EoVc9OdyaNcdo1qwCAQHe/PTTE9SuXQJ/f63PpJS7crkxCi0z7jjnzyfQr99cWracll7Er1GjspoklHJzLne21a6nvGeM4YcfdjFs2E/89VciY8a00iJ+SuUjrpcodDA7z7344lL+7//+oGHDMqxY0Z26dUs6OiSlVB5yubOttijyhjGG5OQ0vL096dHjfipWLMyIEU3w9HS93kql1L1xub96Hcy2v0OHLtKu3QzeeGMlAG3aVOallyI0SSiVT7ncX/71FoWHuFzoTi81NY2PP15H3boT2bz5NDVqFHd0SEopJ+B6XU8YCngW0NpBuWzv3vP87W/z+eOPk3TrVp2JE7tStmwhR4ellHICrpcojNGBbDtISzOcOhXLd9/1ok+f2pqIlVLpXO6Me71Foe7dH3+cZMGCvbz7bjtq1SrBoUPD8fb2dHRYSikn43Id/cZoorhXCQnJvPzyMpo2ncL06dvTi/hpklBKZcX1WhTG6F3Z92DVqiMMGrSQw4f/4tlnG/D++w9QuLAW8VNK3Z7LnXG16+nuxcUl0bv3jxQp4sOqVX+jdetKjg5JKeUCXC9RaIvijv3661FatqyYoYhfMH5+mmyVUrZxuTEK0JvtbBUTE89jj82hTZvpfPvtDgAaNiyrSUIpdUdc7qu5DmbnzBjDd9/9yfDhPxEbm8S4cW20iJ9S6q65ZKLQ+yiyN2zYT4wfv5EmTcoxZUp3atUq4eiQlFIuzOXOuDqYnbW0NENKiqWI3yOP1KJq1WIMG9ZI6zMppe6ZXc8iItJJRPaJyEEReTWL5U+IyA7rT5SIhOS0Tx3MvtWBAxdo23Y6o0evAKB160pa6VUplWvsdiYREU9gPNAZqAU8JiK1Mq12BGhljKkHjAMm5bRfbVHckJKSxocfRlGv3hds23aGmjW1i0kplfvs+dW8EXDQGHMYQERmAQ8Bu6+vYIyJyrD+eqBcTjvVwWyLPXti6N9/Pps2neKhh2owYUJXypQJdHRYSik3ZM9EURY4kWE6GmiczfoDgZ+yWiAig4HBAN7B3jqYbXX2bBzff/8IvXvX0iJ+Sim7secZN6szl8lyRZE2WBJF86yWG2MmYe2W8i/rb/Jri2L9+mgWLNjLv//9ADVrWor4FSig9ZmUUvZlz9HOaKB8hulywKnMK4lIPWAy8JAx5kJOO82Pg9nx8UmMHLmUiIgpzJy5M72InyYJpVResGei2AhUE5HKIuIN9AUiM64gIhWAucCTxpj9tuw0vw1m//LLYerUmcinn25gyJCG7No1hBIl/B0dllIqH7HbV3NjTIqIDAV+BjyBqcaYXSLynHX5F8A/geLABGsfe4oxJjyH/eabRBEXl0TfvrMpVsyX3357ihYtKjo6JKVUPmTXPhxjzBJgSaZ5X2R4PQgYdEf7xP3vzF658gitWlmK+P38cz9q1SqBr2/+SI5KKefjcndkuXOL4uzZOB599EfatZuRXsSvQYMymiSUUg7lcl/NDe43mG2M4dtvdzBixM/ExSXx7rttefzxuo4OSymlABdMFBj3KzP+wgtLmDhxE02bWor46R3WSiln4nKJwl2uekpLMyQnp1KwoBd9+tSmZs0ghgxpqPWZlFJOx+XOSu5QZnzfvvO0ajWN0aNXAtCqVSWGDWusSUIp5ZRc7szkyi2K5ORU3nvvd0JCvuDPP89Rt26wo0NSSqkcudxXc1e9M3vXrnM8+eQ8tm49Q8+eNRk/vgulSgU4OiyllMqR651xcc3BbE9PDy5evMrs2b3p1StztXWllHJeLtf1BK6TKKKiTvDKK8sBuP/+IA4eHK5JQinlclwyUTj7YHZcXBLDh/9E8+ZT+f77XZw/nwCAl5dLHm6lVD7n3Gfc23DmFsWyZYcYPHghx49fZujQRvzrX+0ICPB2dFhKKXXXXDJROOtgdlxcEk88MZfixX1Zs+ZpmjWr4OiQlFLqnjnnGTcHztaiWL78EG3bViYgwJtly/pRs2YJfHxc8tAqpdQtXLLT3FkSxenTsfTq9QMdOnzLzJk7AQgLK61JQinlVlzyjOboridjDNOnb2fkyJ+5ejWZ995rp0X8lFJuyyUThaNbFM8/v5gvv9xM8+YVmDy5GzVqBDk0HmVfycnJREdHk5iY6OhQlMqRj48P5cqVo0CB3DtPumSicMTlsRmL+D3+eF3q1SvJc8+F4+EheR6LylvR0dEEBgZSqVIlrE9iVMopGWO4cOEC0dHRVK5cOdf2q2MUNtizJ4YWLb7m9ddXANCyZUWGDGmoSSKfSExMpHjx4poklNMTEYoXL57rrV9NFNlITk7lX/9aQ2jol+zde56wsNJ58r7K+WiSUK7CHv9WXbPrKQ8Gs3ftOke/fvPYtu0MvXvX4v/+rzMlS2oRP6VU/qMtitvw8vLg8uVE5s59lB9+6K1JQjmNsWPH8uGHH97VthEREdku79KlC5cuXbqrfWc0f/58du/efc/7yW7/b7/9tt32f6c2b95M3bp1qVq1KsOHD8cYc8s6SUlJPP3009StW5eQkBB+/fXX9GWjR4+mfPnyBATcfJ45fvw4bdq0ISwsjHr16rFkyRIAYmJi6NSpk10/U0YumSjsNZi9Zs0xXn55GQA1agSxf/8wevSoaZf3UsoRoqKisl2+ZMkSihQpcs/vk12iSElJuef9f/DBBwwZMuSe95Nbnn/+eSZNmsSBAwc4cOAAS5cuvWWdr776CoCdO3eyfPlyXnrpJdLS0gDo1q0bf/zxxy3bvPPOOzz66KNs3bqVWbNmpX/mEiVKULp0adauXWvHT3WDS3Y95XaLIjb2Gq+++gsTJmyicuUivPpqc4KC/LSIn7rFiFkj2HZiW67uM7R8KJ/2/TTbdd59911mzJhB+fLlKVGiBA0aNADg0KFDvPDCC8TExODn58dXX33F/fffz9mzZ3nuuec4fPgwABMnTiQiIoKAgADi4uI4ffo0ffr04cqVK6SkpDBx4kRatGhBpUqV2LRpE0FBQXz88cdMnToVgEGDBjFixAiOHj1K586dad68OVFRUZQtW5YFCxbg6+ubHmtUVBSRkZGsXr2ad955hzlz5jBw4EAiIiJYu3Yt3bt3p3Xr1owaNYq4uDiCgoKYNm0apUuXvu3nyWj//v0ULFiQoCDLZekLFy7knXfeISkpieLFizNz5kxKlizJ2LFjCQgI4OWXXwagTp06LFq0iEqVKjFjxgw+/PBDRIR69erxzTff3PV/v9OnT3PlyhWaNm0KQP/+/Zk/fz6dO3e+ab3du3fTrl07AIKDgylSpAibNm2iUaNGNGnSJMt9iwhXrlwB4PLly5QpUyZ92cMPP8zMmTNp1qzZXcduq3yfKH766QDPPruI6OgrjBjRmHfeaYu/vxbxU85j8+bNzJo1i61bt5KSkkL9+vXTE8XgwYP54osvqFatGhs2bGDIkCGsXLmS4cOH06pVK+bNm0dqaipxcXE37fN///sfHTt2ZPTo0aSmppKQkHDLe3799dds2LABYwyNGzemVatWFC1alAMHDvDdd9/x1Vdf8eijjzJnzhz69euXvm1ERATdu3fnwQcf5JFHHkmff+nSJVavXk1ycjKtWrViwYIFlChRgu+//57Ro0czderU236ejNauXUv9+vXTp5s3b8769esRESZPnswHH3zARx99dNvjuWvXLt59913Wrl1LUFAQFy9evGWdVatWMXLkyFvm+/n53dIqO3nyJOXKlUufLleuHCdPnrxl25CQEBYsWEDfvn05ceIEmzdv5sSJEzRq1Oi2sY4dO5YOHTrwf//3f8THx/PLL7+kLwsPD+eNN9647ba5ySUTRW4NZsfGXqN///kEB/sTFTWQJk3K5byRytdy+uZvD2vWrKFHjx74+fkB0L17dwDi4uKIioqid+/e6eteu3YNgJUrVzJjxgwAPD09KVy48E37bNiwIQMGDCA5OZmHH36Y0NDQm5b//vvv9OjRA39/fwB69uzJmjVr6N69O5UrV05fv0GDBhw9etSmz9GnTx8A9u3bx59//kn79u0BSE1NpXTp0tl+noxOnz5NiRIl0qejo6Pp06cPp0+fJikpKcf7B1auXMkjjzyS3iIpVqzYLeu0adOGbdu22fS5shqPyOrKowEDBrBnzx7Cw8OpWLEiEREReHllfy777rvveOqpp3jppZdYt24dTz75JH/++SceHh4EBwdz6tQpm2K8Vy6ZKO6lRWGM4eefD9G+/X0EBhbkl1+e5P77gyhY0CUPhconsjrxpKWlUaRIEZtPaBm1bNmS3377jcWLF/Pkk0/y97//nf79+6cvz+rkd13BggXTX3t6enL16lWb3vN60jHGULt2bdatW3fT8itXrtj0eXx9fbl8+XL69LBhwxg1ahTdu3fn119/ZezYsQB4eXmljwEA6fcWGGNyvIT0TloU5cqVIzo6On06Ojr6pi6i67y8vPjk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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fpr_tree, tpr_tree, _ = roc_curve(y_test, \n",
    "                                  tree.predict_proba(X_test)[:,1])\n",
    "plot_roc_curve(fpr_tree, tpr_tree, 'decision tree', 'darkgreen')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.9181977570759967"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fpr, tpr, _ = roc_curve(y_test, tree.predict_proba(X_test)[:,1])\n",
    "auc(fpr, tpr)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8303818200429931"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tree.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "import xgboost as xgb\n",
    "from xgboost import plot_importance\n",
    "#import pan\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [],
   "source": [
    "dtrain = xgb.DMatrix(data=X_train, label=y_train)\n",
    "dtest = xgb.DMatrix(data=X_test, label=y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {},
   "outputs": [],
   "source": [
    "params = {\n",
    "         'learning_rate ': 0.01,\n",
    "         'max_depth':3,\n",
    "         'boosting' : 'gblinear',\n",
    "         'objective':'binary:logistic',\n",
    "         'metric':'binary_logloss',\n",
    "         'is_training_metric':True,\n",
    "         'num_leaves':144,\n",
    "         'nrounds':1500,\n",
    "         'feature_fraction':0.9,\n",
    "         'bagging_fraction':0.7,\n",
    "         'bagging_freq':5,\n",
    "         'seed':2020}\n",
    "\n",
    "         \n",
    "\n",
    "num_rounds = 1000"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[12:24:16] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.3.0/src/learner.cc:541: \n",
      "Parameters: { bagging_fraction, bagging_freq, boosting, feature_fraction, is_training_metric, learning_rate , metric, nrounds, num_leaves } might not be used.\n",
      "\n",
      "  This may not be accurate due to some parameters are only used in language bindings but\n",
      "  passed down to XGBoost core.  Or some parameters are not used but slip through this\n",
      "  verification. Please open an issue if you find above cases.\n",
      "\n",
      "\n",
      "[12:24:16] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.3.0/src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.\n",
      "[0]\ttrain-logloss:0.56307\teval-logloss:0.56405\n",
      "[1]\ttrain-logloss:0.49154\teval-logloss:0.49376\n",
      "[2]\ttrain-logloss:0.44616\teval-logloss:0.44954\n",
      "[3]\ttrain-logloss:0.41087\teval-logloss:0.41451\n",
      "[4]\ttrain-logloss:0.38877\teval-logloss:0.39216\n",
      "[5]\ttrain-logloss:0.37157\teval-logloss:0.37544\n",
      "[6]\ttrain-logloss:0.35655\teval-logloss:0.36091\n",
      "[7]\ttrain-logloss:0.34714\teval-logloss:0.35202\n",
      "[8]\ttrain-logloss:0.33985\teval-logloss:0.34453\n",
      "[9]\ttrain-logloss:0.33422\teval-logloss:0.33887\n",
      "[10]\ttrain-logloss:0.32790\teval-logloss:0.33272\n",
      "[11]\ttrain-logloss:0.32399\teval-logloss:0.32910\n",
      "[12]\ttrain-logloss:0.32090\teval-logloss:0.32653\n",
      "[13]\ttrain-logloss:0.31624\teval-logloss:0.32205\n",
      "[14]\ttrain-logloss:0.31444\teval-logloss:0.32021\n",
      "[15]\ttrain-logloss:0.31276\teval-logloss:0.31871\n",
      "[16]\ttrain-logloss:0.31140\teval-logloss:0.31746\n",
      "[17]\ttrain-logloss:0.30952\teval-logloss:0.31569\n",
      "[18]\ttrain-logloss:0.30673\teval-logloss:0.31280\n",
      "[19]\ttrain-logloss:0.30519\teval-logloss:0.31199\n",
      "[20]\ttrain-logloss:0.30443\teval-logloss:0.31121\n",
      "[21]\ttrain-logloss:0.30291\teval-logloss:0.30964\n",
      "[22]\ttrain-logloss:0.30237\teval-logloss:0.30907\n",
      "[23]\ttrain-logloss:0.29873\teval-logloss:0.30537\n",
      "[24]\ttrain-logloss:0.29764\teval-logloss:0.30468\n",
      "[25]\ttrain-logloss:0.29632\teval-logloss:0.30373\n",
      "[26]\ttrain-logloss:0.29586\teval-logloss:0.30331\n",
      "[27]\ttrain-logloss:0.29536\teval-logloss:0.30296\n",
      "[28]\ttrain-logloss:0.29478\teval-logloss:0.30247\n",
      "[29]\ttrain-logloss:0.29445\teval-logloss:0.30221\n",
      "[30]\ttrain-logloss:0.29257\teval-logloss:0.30019\n",
      "[31]\ttrain-logloss:0.29208\teval-logloss:0.30002\n",
      "[32]\ttrain-logloss:0.29175\teval-logloss:0.29983\n",
      "[33]\ttrain-logloss:0.29115\teval-logloss:0.29942\n",
      "[34]\ttrain-logloss:0.29051\teval-logloss:0.29897\n",
      "[35]\ttrain-logloss:0.28953\teval-logloss:0.29802\n",
      "[36]\ttrain-logloss:0.28935\teval-logloss:0.29784\n",
      "[37]\ttrain-logloss:0.28908\teval-logloss:0.29776\n",
      "[38]\ttrain-logloss:0.28880\teval-logloss:0.29769\n",
      "[39]\ttrain-logloss:0.28834\teval-logloss:0.29748\n",
      "[40]\ttrain-logloss:0.28773\teval-logloss:0.29696\n",
      "[41]\ttrain-logloss:0.28741\teval-logloss:0.29675\n",
      "[42]\ttrain-logloss:0.28717\teval-logloss:0.29655\n",
      "[43]\ttrain-logloss:0.28702\teval-logloss:0.29646\n",
      "[44]\ttrain-logloss:0.28651\teval-logloss:0.29650\n",
      "[45]\ttrain-logloss:0.28578\teval-logloss:0.29617\n",
      "[46]\ttrain-logloss:0.28538\teval-logloss:0.29628\n",
      "[47]\ttrain-logloss:0.28526\teval-logloss:0.29630\n",
      "[48]\ttrain-logloss:0.28492\teval-logloss:0.29606\n",
      "[49]\ttrain-logloss:0.28448\teval-logloss:0.29594\n",
      "[50]\ttrain-logloss:0.28408\teval-logloss:0.29609\n",
      "[51]\ttrain-logloss:0.28377\teval-logloss:0.29598\n",
      "[52]\ttrain-logloss:0.28335\teval-logloss:0.29592\n",
      "[53]\ttrain-logloss:0.28279\teval-logloss:0.29585\n",
      "[54]\ttrain-logloss:0.28267\teval-logloss:0.29579\n",
      "[55]\ttrain-logloss:0.28258\teval-logloss:0.29577\n",
      "[56]\ttrain-logloss:0.28221\teval-logloss:0.29539\n",
      "[57]\ttrain-logloss:0.28211\teval-logloss:0.29536\n",
      "[58]\ttrain-logloss:0.28181\teval-logloss:0.29553\n",
      "[59]\ttrain-logloss:0.28170\teval-logloss:0.29557\n",
      "[60]\ttrain-logloss:0.28141\teval-logloss:0.29550\n",
      "[61]\ttrain-logloss:0.28108\teval-logloss:0.29553\n",
      "[62]\ttrain-logloss:0.28083\teval-logloss:0.29572\n",
      "[63]\ttrain-logloss:0.28066\teval-logloss:0.29574\n",
      "[64]\ttrain-logloss:0.28056\teval-logloss:0.29577\n",
      "[65]\ttrain-logloss:0.28038\teval-logloss:0.29576\n",
      "[66]\ttrain-logloss:0.27998\teval-logloss:0.29570\n",
      "[67]\ttrain-logloss:0.27962\teval-logloss:0.29558\n",
      "[68]\ttrain-logloss:0.27886\teval-logloss:0.29508\n",
      "[69]\ttrain-logloss:0.27855\teval-logloss:0.29480\n",
      "[70]\ttrain-logloss:0.27811\teval-logloss:0.29468\n",
      "[71]\ttrain-logloss:0.27777\teval-logloss:0.29460\n",
      "[72]\ttrain-logloss:0.27756\teval-logloss:0.29463\n",
      "[73]\ttrain-logloss:0.27741\teval-logloss:0.29464\n",
      "[74]\ttrain-logloss:0.27729\teval-logloss:0.29461\n",
      "[75]\ttrain-logloss:0.27724\teval-logloss:0.29465\n",
      "[76]\ttrain-logloss:0.27694\teval-logloss:0.29474\n",
      "[77]\ttrain-logloss:0.27663\teval-logloss:0.29467\n",
      "[78]\ttrain-logloss:0.27589\teval-logloss:0.29393\n",
      "[79]\ttrain-logloss:0.27575\teval-logloss:0.29408\n",
      "[80]\ttrain-logloss:0.27553\teval-logloss:0.29413\n",
      "[81]\ttrain-logloss:0.27550\teval-logloss:0.29411\n",
      "[82]\ttrain-logloss:0.27536\teval-logloss:0.29419\n",
      "[83]\ttrain-logloss:0.27505\teval-logloss:0.29406\n",
      "[84]\ttrain-logloss:0.27470\teval-logloss:0.29389\n",
      "[85]\ttrain-logloss:0.27451\teval-logloss:0.29394\n",
      "[86]\ttrain-logloss:0.27420\teval-logloss:0.29405\n",
      "[87]\ttrain-logloss:0.27412\teval-logloss:0.29402\n",
      "[88]\ttrain-logloss:0.27398\teval-logloss:0.29402\n",
      "[89]\ttrain-logloss:0.27377\teval-logloss:0.29403\n",
      "[90]\ttrain-logloss:0.27363\teval-logloss:0.29404\n",
      "[91]\ttrain-logloss:0.27341\teval-logloss:0.29392\n",
      "[92]\ttrain-logloss:0.27314\teval-logloss:0.29405\n",
      "[93]\ttrain-logloss:0.27289\teval-logloss:0.29417\n",
      "[94]\ttrain-logloss:0.27270\teval-logloss:0.29410\n",
      "[95]\ttrain-logloss:0.27243\teval-logloss:0.29408\n",
      "[96]\ttrain-logloss:0.27227\teval-logloss:0.29416\n",
      "[97]\ttrain-logloss:0.27220\teval-logloss:0.29418\n",
      "[98]\ttrain-logloss:0.27205\teval-logloss:0.29430\n",
      "[99]\ttrain-logloss:0.27171\teval-logloss:0.29436\n",
      "[100]\ttrain-logloss:0.27126\teval-logloss:0.29442\n",
      "[101]\ttrain-logloss:0.27087\teval-logloss:0.29435\n",
      "[102]\ttrain-logloss:0.27069\teval-logloss:0.29430\n",
      "[103]\ttrain-logloss:0.27021\teval-logloss:0.29410\n",
      "[104]\ttrain-logloss:0.26986\teval-logloss:0.29409\n",
      "[105]\ttrain-logloss:0.26965\teval-logloss:0.29402\n",
      "[106]\ttrain-logloss:0.26955\teval-logloss:0.29399\n",
      "[107]\ttrain-logloss:0.26931\teval-logloss:0.29404\n",
      "[108]\ttrain-logloss:0.26914\teval-logloss:0.29411\n",
      "[109]\ttrain-logloss:0.26905\teval-logloss:0.29415\n",
      "[110]\ttrain-logloss:0.26897\teval-logloss:0.29413\n",
      "[111]\ttrain-logloss:0.26887\teval-logloss:0.29416\n",
      "[112]\ttrain-logloss:0.26883\teval-logloss:0.29425\n",
      "[113]\ttrain-logloss:0.26879\teval-logloss:0.29418\n",
      "[114]\ttrain-logloss:0.26863\teval-logloss:0.29417\n",
      "[115]\ttrain-logloss:0.26835\teval-logloss:0.29437\n",
      "[116]\ttrain-logloss:0.26808\teval-logloss:0.29448\n",
      "[117]\ttrain-logloss:0.26782\teval-logloss:0.29432\n",
      "[118]\ttrain-logloss:0.26766\teval-logloss:0.29439\n",
      "[119]\ttrain-logloss:0.26756\teval-logloss:0.29439\n",
      "[120]\ttrain-logloss:0.26729\teval-logloss:0.29418\n",
      "[121]\ttrain-logloss:0.26704\teval-logloss:0.29428\n",
      "[122]\ttrain-logloss:0.26680\teval-logloss:0.29416\n",
      "[123]\ttrain-logloss:0.26660\teval-logloss:0.29421\n",
      "[124]\ttrain-logloss:0.26643\teval-logloss:0.29422\n",
      "[125]\ttrain-logloss:0.26620\teval-logloss:0.29411\n",
      "[126]\ttrain-logloss:0.26599\teval-logloss:0.29416\n",
      "[127]\ttrain-logloss:0.26576\teval-logloss:0.29409\n",
      "[128]\ttrain-logloss:0.26563\teval-logloss:0.29420\n",
      "[129]\ttrain-logloss:0.26541\teval-logloss:0.29418\n",
      "[130]\ttrain-logloss:0.26539\teval-logloss:0.29414\n",
      "[131]\ttrain-logloss:0.26525\teval-logloss:0.29408\n",
      "[132]\ttrain-logloss:0.26491\teval-logloss:0.29392\n",
      "[133]\ttrain-logloss:0.26473\teval-logloss:0.29401\n",
      "[134]\ttrain-logloss:0.26459\teval-logloss:0.29390\n",
      "[135]\ttrain-logloss:0.26443\teval-logloss:0.29407\n",
      "[136]\ttrain-logloss:0.26419\teval-logloss:0.29406\n",
      "[137]\ttrain-logloss:0.26416\teval-logloss:0.29406\n",
      "[138]\ttrain-logloss:0.26397\teval-logloss:0.29412\n",
      "[139]\ttrain-logloss:0.26370\teval-logloss:0.29405\n",
      "[140]\ttrain-logloss:0.26352\teval-logloss:0.29406\n",
      "[141]\ttrain-logloss:0.26323\teval-logloss:0.29397\n",
      "[142]\ttrain-logloss:0.26302\teval-logloss:0.29393\n",
      "[143]\ttrain-logloss:0.26287\teval-logloss:0.29389\n",
      "[144]\ttrain-logloss:0.26270\teval-logloss:0.29374\n",
      "[145]\ttrain-logloss:0.26251\teval-logloss:0.29380\n",
      "[146]\ttrain-logloss:0.26223\teval-logloss:0.29377\n",
      "[147]\ttrain-logloss:0.26221\teval-logloss:0.29376\n",
      "[148]\ttrain-logloss:0.26211\teval-logloss:0.29382\n",
      "[149]\ttrain-logloss:0.26170\teval-logloss:0.29384\n",
      "[150]\ttrain-logloss:0.26161\teval-logloss:0.29391\n",
      "[151]\ttrain-logloss:0.26141\teval-logloss:0.29414\n",
      "[152]\ttrain-logloss:0.26120\teval-logloss:0.29419\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[153]\ttrain-logloss:0.26112\teval-logloss:0.29422\n",
      "[154]\ttrain-logloss:0.26109\teval-logloss:0.29429\n",
      "[155]\ttrain-logloss:0.26104\teval-logloss:0.29424\n",
      "[156]\ttrain-logloss:0.26089\teval-logloss:0.29426\n",
      "[157]\ttrain-logloss:0.26066\teval-logloss:0.29418\n",
      "[158]\ttrain-logloss:0.26038\teval-logloss:0.29426\n",
      "[159]\ttrain-logloss:0.26023\teval-logloss:0.29416\n",
      "[160]\ttrain-logloss:0.26014\teval-logloss:0.29428\n",
      "[161]\ttrain-logloss:0.26009\teval-logloss:0.29429\n",
      "[162]\ttrain-logloss:0.25996\teval-logloss:0.29431\n",
      "[163]\ttrain-logloss:0.25983\teval-logloss:0.29431\n",
      "[164]\ttrain-logloss:0.25970\teval-logloss:0.29430\n",
      "[165]\ttrain-logloss:0.25958\teval-logloss:0.29424\n",
      "[166]\ttrain-logloss:0.25948\teval-logloss:0.29434\n",
      "[167]\ttrain-logloss:0.25923\teval-logloss:0.29432\n",
      "[168]\ttrain-logloss:0.25915\teval-logloss:0.29430\n",
      "[169]\ttrain-logloss:0.25906\teval-logloss:0.29431\n",
      "[170]\ttrain-logloss:0.25897\teval-logloss:0.29423\n",
      "[171]\ttrain-logloss:0.25876\teval-logloss:0.29416\n",
      "[172]\ttrain-logloss:0.25853\teval-logloss:0.29421\n",
      "[173]\ttrain-logloss:0.25845\teval-logloss:0.29421\n",
      "[174]\ttrain-logloss:0.25840\teval-logloss:0.29422\n",
      "[175]\ttrain-logloss:0.25816\teval-logloss:0.29423\n",
      "[176]\ttrain-logloss:0.25801\teval-logloss:0.29418\n",
      "[177]\ttrain-logloss:0.25797\teval-logloss:0.29418\n",
      "[178]\ttrain-logloss:0.25790\teval-logloss:0.29429\n",
      "[179]\ttrain-logloss:0.25784\teval-logloss:0.29435\n",
      "[180]\ttrain-logloss:0.25745\teval-logloss:0.29421\n",
      "[181]\ttrain-logloss:0.25722\teval-logloss:0.29416\n",
      "[182]\ttrain-logloss:0.25688\teval-logloss:0.29406\n",
      "[183]\ttrain-logloss:0.25654\teval-logloss:0.29408\n",
      "[184]\ttrain-logloss:0.25628\teval-logloss:0.29418\n",
      "[185]\ttrain-logloss:0.25601\teval-logloss:0.29408\n",
      "[186]\ttrain-logloss:0.25580\teval-logloss:0.29426\n",
      "[187]\ttrain-logloss:0.25550\teval-logloss:0.29412\n",
      "[188]\ttrain-logloss:0.25528\teval-logloss:0.29405\n",
      "[189]\ttrain-logloss:0.25504\teval-logloss:0.29414\n",
      "[190]\ttrain-logloss:0.25492\teval-logloss:0.29420\n",
      "[191]\ttrain-logloss:0.25482\teval-logloss:0.29424\n",
      "[192]\ttrain-logloss:0.25455\teval-logloss:0.29413\n",
      "[193]\ttrain-logloss:0.25451\teval-logloss:0.29422\n",
      "[194]\ttrain-logloss:0.25419\teval-logloss:0.29429\n",
      "[195]\ttrain-logloss:0.25412\teval-logloss:0.29429\n",
      "[196]\ttrain-logloss:0.25392\teval-logloss:0.29444\n",
      "[197]\ttrain-logloss:0.25372\teval-logloss:0.29444\n",
      "[198]\ttrain-logloss:0.25358\teval-logloss:0.29451\n",
      "[199]\ttrain-logloss:0.25354\teval-logloss:0.29456\n",
      "[200]\ttrain-logloss:0.25329\teval-logloss:0.29451\n",
      "[201]\ttrain-logloss:0.25300\teval-logloss:0.29446\n",
      "[202]\ttrain-logloss:0.25288\teval-logloss:0.29451\n",
      "[203]\ttrain-logloss:0.25274\teval-logloss:0.29440\n",
      "[204]\ttrain-logloss:0.25272\teval-logloss:0.29445\n",
      "[205]\ttrain-logloss:0.25257\teval-logloss:0.29442\n",
      "[206]\ttrain-logloss:0.25236\teval-logloss:0.29451\n",
      "[207]\ttrain-logloss:0.25223\teval-logloss:0.29454\n",
      "[208]\ttrain-logloss:0.25213\teval-logloss:0.29457\n",
      "[209]\ttrain-logloss:0.25207\teval-logloss:0.29464\n",
      "[210]\ttrain-logloss:0.25177\teval-logloss:0.29463\n",
      "[211]\ttrain-logloss:0.25148\teval-logloss:0.29451\n",
      "[212]\ttrain-logloss:0.25146\teval-logloss:0.29457\n",
      "[213]\ttrain-logloss:0.25136\teval-logloss:0.29449\n",
      "[214]\ttrain-logloss:0.25113\teval-logloss:0.29453\n",
      "[215]\ttrain-logloss:0.25094\teval-logloss:0.29462\n",
      "[216]\ttrain-logloss:0.25084\teval-logloss:0.29464\n",
      "[217]\ttrain-logloss:0.25069\teval-logloss:0.29454\n",
      "[218]\ttrain-logloss:0.25067\teval-logloss:0.29455\n",
      "[219]\ttrain-logloss:0.25052\teval-logloss:0.29462\n",
      "[220]\ttrain-logloss:0.25035\teval-logloss:0.29462\n",
      "[221]\ttrain-logloss:0.25024\teval-logloss:0.29458\n",
      "[222]\ttrain-logloss:0.25013\teval-logloss:0.29465\n",
      "[223]\ttrain-logloss:0.24999\teval-logloss:0.29466\n",
      "[224]\ttrain-logloss:0.24994\teval-logloss:0.29471\n",
      "[225]\ttrain-logloss:0.24976\teval-logloss:0.29476\n",
      "[226]\ttrain-logloss:0.24963\teval-logloss:0.29474\n",
      "[227]\ttrain-logloss:0.24935\teval-logloss:0.29480\n",
      "[228]\ttrain-logloss:0.24918\teval-logloss:0.29475\n",
      "[229]\ttrain-logloss:0.24903\teval-logloss:0.29476\n",
      "[230]\ttrain-logloss:0.24893\teval-logloss:0.29478\n",
      "[231]\ttrain-logloss:0.24878\teval-logloss:0.29477\n",
      "[232]\ttrain-logloss:0.24843\teval-logloss:0.29484\n",
      "[233]\ttrain-logloss:0.24827\teval-logloss:0.29484\n",
      "[234]\ttrain-logloss:0.24823\teval-logloss:0.29479\n",
      "[235]\ttrain-logloss:0.24808\teval-logloss:0.29486\n",
      "[236]\ttrain-logloss:0.24799\teval-logloss:0.29486\n",
      "[237]\ttrain-logloss:0.24787\teval-logloss:0.29487\n",
      "[238]\ttrain-logloss:0.24764\teval-logloss:0.29477\n",
      "[239]\ttrain-logloss:0.24748\teval-logloss:0.29468\n",
      "[240]\ttrain-logloss:0.24735\teval-logloss:0.29472\n",
      "[241]\ttrain-logloss:0.24730\teval-logloss:0.29477\n",
      "[242]\ttrain-logloss:0.24716\teval-logloss:0.29476\n",
      "[243]\ttrain-logloss:0.24699\teval-logloss:0.29476\n",
      "[244]\ttrain-logloss:0.24695\teval-logloss:0.29479\n",
      "[245]\ttrain-logloss:0.24692\teval-logloss:0.29478\n",
      "[246]\ttrain-logloss:0.24687\teval-logloss:0.29481\n",
      "[247]\ttrain-logloss:0.24674\teval-logloss:0.29470\n",
      "[248]\ttrain-logloss:0.24657\teval-logloss:0.29481\n",
      "[249]\ttrain-logloss:0.24641\teval-logloss:0.29483\n",
      "[250]\ttrain-logloss:0.24634\teval-logloss:0.29483\n",
      "[251]\ttrain-logloss:0.24631\teval-logloss:0.29480\n",
      "[252]\ttrain-logloss:0.24621\teval-logloss:0.29495\n",
      "[253]\ttrain-logloss:0.24619\teval-logloss:0.29499\n",
      "[254]\ttrain-logloss:0.24616\teval-logloss:0.29500\n",
      "[255]\ttrain-logloss:0.24596\teval-logloss:0.29514\n",
      "[256]\ttrain-logloss:0.24573\teval-logloss:0.29511\n",
      "[257]\ttrain-logloss:0.24556\teval-logloss:0.29504\n",
      "[258]\ttrain-logloss:0.24546\teval-logloss:0.29498\n",
      "[259]\ttrain-logloss:0.24515\teval-logloss:0.29471\n",
      "[260]\ttrain-logloss:0.24500\teval-logloss:0.29485\n",
      "[261]\ttrain-logloss:0.24482\teval-logloss:0.29501\n",
      "[262]\ttrain-logloss:0.24463\teval-logloss:0.29502\n",
      "[263]\ttrain-logloss:0.24454\teval-logloss:0.29499\n",
      "[264]\ttrain-logloss:0.24439\teval-logloss:0.29504\n",
      "[265]\ttrain-logloss:0.24426\teval-logloss:0.29505\n",
      "[266]\ttrain-logloss:0.24411\teval-logloss:0.29526\n",
      "[267]\ttrain-logloss:0.24397\teval-logloss:0.29531\n",
      "[268]\ttrain-logloss:0.24385\teval-logloss:0.29538\n",
      "[269]\ttrain-logloss:0.24384\teval-logloss:0.29539\n",
      "[270]\ttrain-logloss:0.24353\teval-logloss:0.29529\n",
      "[271]\ttrain-logloss:0.24343\teval-logloss:0.29535\n",
      "[272]\ttrain-logloss:0.24327\teval-logloss:0.29525\n",
      "[273]\ttrain-logloss:0.24312\teval-logloss:0.29538\n",
      "[274]\ttrain-logloss:0.24288\teval-logloss:0.29536\n",
      "[275]\ttrain-logloss:0.24270\teval-logloss:0.29555\n",
      "[276]\ttrain-logloss:0.24249\teval-logloss:0.29558\n",
      "[277]\ttrain-logloss:0.24240\teval-logloss:0.29560\n",
      "[278]\ttrain-logloss:0.24231\teval-logloss:0.29558\n",
      "[279]\ttrain-logloss:0.24216\teval-logloss:0.29564\n",
      "[280]\ttrain-logloss:0.24193\teval-logloss:0.29560\n",
      "[281]\ttrain-logloss:0.24192\teval-logloss:0.29558\n",
      "[282]\ttrain-logloss:0.24173\teval-logloss:0.29567\n",
      "[283]\ttrain-logloss:0.24168\teval-logloss:0.29567\n",
      "[284]\ttrain-logloss:0.24157\teval-logloss:0.29573\n",
      "[285]\ttrain-logloss:0.24152\teval-logloss:0.29573\n",
      "[286]\ttrain-logloss:0.24141\teval-logloss:0.29574\n",
      "[287]\ttrain-logloss:0.24129\teval-logloss:0.29575\n",
      "[288]\ttrain-logloss:0.24124\teval-logloss:0.29573\n",
      "[289]\ttrain-logloss:0.24117\teval-logloss:0.29579\n",
      "[290]\ttrain-logloss:0.24108\teval-logloss:0.29578\n",
      "[291]\ttrain-logloss:0.24089\teval-logloss:0.29589\n",
      "[292]\ttrain-logloss:0.24078\teval-logloss:0.29615\n",
      "[293]\ttrain-logloss:0.24072\teval-logloss:0.29617\n",
      "[294]\ttrain-logloss:0.24063\teval-logloss:0.29620\n",
      "[295]\ttrain-logloss:0.24044\teval-logloss:0.29630\n",
      "[296]\ttrain-logloss:0.24034\teval-logloss:0.29628\n",
      "[297]\ttrain-logloss:0.24016\teval-logloss:0.29636\n",
      "[298]\ttrain-logloss:0.24011\teval-logloss:0.29633\n",
      "[299]\ttrain-logloss:0.23993\teval-logloss:0.29629\n",
      "[300]\ttrain-logloss:0.23975\teval-logloss:0.29630\n",
      "[301]\ttrain-logloss:0.23965\teval-logloss:0.29621\n",
      "[302]\ttrain-logloss:0.23950\teval-logloss:0.29623\n",
      "[303]\ttrain-logloss:0.23923\teval-logloss:0.29627\n",
      "[304]\ttrain-logloss:0.23890\teval-logloss:0.29623\n",
      "[305]\ttrain-logloss:0.23880\teval-logloss:0.29635\n",
      "[306]\ttrain-logloss:0.23872\teval-logloss:0.29640\n",
      "[307]\ttrain-logloss:0.23865\teval-logloss:0.29638\n",
      "[308]\ttrain-logloss:0.23848\teval-logloss:0.29629\n",
      "[309]\ttrain-logloss:0.23841\teval-logloss:0.29621\n",
      "[310]\ttrain-logloss:0.23839\teval-logloss:0.29623\n",
      "[311]\ttrain-logloss:0.23830\teval-logloss:0.29620\n",
      "[312]\ttrain-logloss:0.23815\teval-logloss:0.29636\n",
      "[313]\ttrain-logloss:0.23806\teval-logloss:0.29638\n",
      "[314]\ttrain-logloss:0.23802\teval-logloss:0.29645\n",
      "[315]\ttrain-logloss:0.23800\teval-logloss:0.29650\n",
      "[316]\ttrain-logloss:0.23785\teval-logloss:0.29652\n",
      "[317]\ttrain-logloss:0.23775\teval-logloss:0.29657\n",
      "[318]\ttrain-logloss:0.23750\teval-logloss:0.29652\n",
      "[319]\ttrain-logloss:0.23732\teval-logloss:0.29663\n",
      "[320]\ttrain-logloss:0.23724\teval-logloss:0.29668\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[321]\ttrain-logloss:0.23719\teval-logloss:0.29668\n",
      "[322]\ttrain-logloss:0.23715\teval-logloss:0.29675\n",
      "[323]\ttrain-logloss:0.23709\teval-logloss:0.29667\n",
      "[324]\ttrain-logloss:0.23708\teval-logloss:0.29671\n",
      "[325]\ttrain-logloss:0.23689\teval-logloss:0.29661\n",
      "[326]\ttrain-logloss:0.23675\teval-logloss:0.29669\n",
      "[327]\ttrain-logloss:0.23661\teval-logloss:0.29675\n",
      "[328]\ttrain-logloss:0.23647\teval-logloss:0.29669\n",
      "[329]\ttrain-logloss:0.23637\teval-logloss:0.29685\n",
      "[330]\ttrain-logloss:0.23636\teval-logloss:0.29686\n",
      "[331]\ttrain-logloss:0.23632\teval-logloss:0.29694\n",
      "[332]\ttrain-logloss:0.23616\teval-logloss:0.29691\n",
      "[333]\ttrain-logloss:0.23609\teval-logloss:0.29700\n",
      "[334]\ttrain-logloss:0.23586\teval-logloss:0.29682\n",
      "[335]\ttrain-logloss:0.23576\teval-logloss:0.29690\n",
      "[336]\ttrain-logloss:0.23559\teval-logloss:0.29688\n",
      "[337]\ttrain-logloss:0.23535\teval-logloss:0.29677\n",
      "[338]\ttrain-logloss:0.23505\teval-logloss:0.29673\n",
      "[339]\ttrain-logloss:0.23490\teval-logloss:0.29679\n",
      "[340]\ttrain-logloss:0.23481\teval-logloss:0.29679\n",
      "[341]\ttrain-logloss:0.23480\teval-logloss:0.29678\n",
      "[342]\ttrain-logloss:0.23452\teval-logloss:0.29664\n",
      "[343]\ttrain-logloss:0.23444\teval-logloss:0.29673\n",
      "[344]\ttrain-logloss:0.23422\teval-logloss:0.29663\n",
      "[345]\ttrain-logloss:0.23415\teval-logloss:0.29672\n",
      "[346]\ttrain-logloss:0.23399\teval-logloss:0.29680\n",
      "[347]\ttrain-logloss:0.23392\teval-logloss:0.29683\n",
      "[348]\ttrain-logloss:0.23390\teval-logloss:0.29683\n",
      "[349]\ttrain-logloss:0.23376\teval-logloss:0.29677\n",
      "[350]\ttrain-logloss:0.23370\teval-logloss:0.29681\n",
      "[351]\ttrain-logloss:0.23366\teval-logloss:0.29685\n",
      "[352]\ttrain-logloss:0.23364\teval-logloss:0.29692\n",
      "[353]\ttrain-logloss:0.23357\teval-logloss:0.29691\n",
      "[354]\ttrain-logloss:0.23344\teval-logloss:0.29690\n",
      "[355]\ttrain-logloss:0.23327\teval-logloss:0.29704\n",
      "[356]\ttrain-logloss:0.23326\teval-logloss:0.29703\n",
      "[357]\ttrain-logloss:0.23324\teval-logloss:0.29700\n",
      "[358]\ttrain-logloss:0.23306\teval-logloss:0.29723\n",
      "[359]\ttrain-logloss:0.23297\teval-logloss:0.29717\n",
      "[360]\ttrain-logloss:0.23283\teval-logloss:0.29713\n",
      "[361]\ttrain-logloss:0.23265\teval-logloss:0.29722\n",
      "[362]\ttrain-logloss:0.23258\teval-logloss:0.29731\n",
      "[363]\ttrain-logloss:0.23250\teval-logloss:0.29729\n",
      "[364]\ttrain-logloss:0.23242\teval-logloss:0.29733\n",
      "[365]\ttrain-logloss:0.23226\teval-logloss:0.29734\n",
      "[366]\ttrain-logloss:0.23217\teval-logloss:0.29741\n",
      "[367]\ttrain-logloss:0.23198\teval-logloss:0.29741\n",
      "[368]\ttrain-logloss:0.23174\teval-logloss:0.29744\n",
      "[369]\ttrain-logloss:0.23164\teval-logloss:0.29751\n",
      "[370]\ttrain-logloss:0.23150\teval-logloss:0.29771\n",
      "[371]\ttrain-logloss:0.23144\teval-logloss:0.29775\n",
      "[372]\ttrain-logloss:0.23128\teval-logloss:0.29766\n",
      "[373]\ttrain-logloss:0.23119\teval-logloss:0.29768\n",
      "[374]\ttrain-logloss:0.23118\teval-logloss:0.29771\n",
      "[375]\ttrain-logloss:0.23114\teval-logloss:0.29768\n",
      "[376]\ttrain-logloss:0.23098\teval-logloss:0.29776\n",
      "[377]\ttrain-logloss:0.23087\teval-logloss:0.29780\n",
      "[378]\ttrain-logloss:0.23070\teval-logloss:0.29771\n",
      "[379]\ttrain-logloss:0.23067\teval-logloss:0.29770\n",
      "[380]\ttrain-logloss:0.23048\teval-logloss:0.29768\n",
      "[381]\ttrain-logloss:0.23036\teval-logloss:0.29764\n",
      "[382]\ttrain-logloss:0.23035\teval-logloss:0.29767\n",
      "[383]\ttrain-logloss:0.23016\teval-logloss:0.29763\n",
      "[384]\ttrain-logloss:0.23009\teval-logloss:0.29764\n",
      "[385]\ttrain-logloss:0.23005\teval-logloss:0.29768\n",
      "[386]\ttrain-logloss:0.23002\teval-logloss:0.29767\n",
      "[387]\ttrain-logloss:0.22995\teval-logloss:0.29776\n",
      "[388]\ttrain-logloss:0.22990\teval-logloss:0.29781\n",
      "[389]\ttrain-logloss:0.22978\teval-logloss:0.29794\n",
      "[390]\ttrain-logloss:0.22961\teval-logloss:0.29798\n",
      "[391]\ttrain-logloss:0.22942\teval-logloss:0.29805\n",
      "[392]\ttrain-logloss:0.22928\teval-logloss:0.29808\n",
      "[393]\ttrain-logloss:0.22907\teval-logloss:0.29803\n",
      "[394]\ttrain-logloss:0.22898\teval-logloss:0.29808\n",
      "[395]\ttrain-logloss:0.22891\teval-logloss:0.29809\n",
      "[396]\ttrain-logloss:0.22874\teval-logloss:0.29803\n",
      "[397]\ttrain-logloss:0.22867\teval-logloss:0.29802\n",
      "[398]\ttrain-logloss:0.22858\teval-logloss:0.29816\n",
      "[399]\ttrain-logloss:0.22852\teval-logloss:0.29817\n",
      "[400]\ttrain-logloss:0.22840\teval-logloss:0.29817\n",
      "[401]\ttrain-logloss:0.22833\teval-logloss:0.29824\n",
      "[402]\ttrain-logloss:0.22820\teval-logloss:0.29826\n",
      "[403]\ttrain-logloss:0.22810\teval-logloss:0.29825\n",
      "[404]\ttrain-logloss:0.22796\teval-logloss:0.29833\n",
      "[405]\ttrain-logloss:0.22783\teval-logloss:0.29821\n",
      "[406]\ttrain-logloss:0.22782\teval-logloss:0.29821\n",
      "[407]\ttrain-logloss:0.22780\teval-logloss:0.29824\n",
      "[408]\ttrain-logloss:0.22773\teval-logloss:0.29823\n",
      "[409]\ttrain-logloss:0.22764\teval-logloss:0.29820\n",
      "[410]\ttrain-logloss:0.22750\teval-logloss:0.29810\n",
      "[411]\ttrain-logloss:0.22732\teval-logloss:0.29807\n",
      "[412]\ttrain-logloss:0.22728\teval-logloss:0.29807\n",
      "[413]\ttrain-logloss:0.22722\teval-logloss:0.29809\n",
      "[414]\ttrain-logloss:0.22719\teval-logloss:0.29814\n",
      "[415]\ttrain-logloss:0.22718\teval-logloss:0.29818\n",
      "[416]\ttrain-logloss:0.22715\teval-logloss:0.29811\n",
      "[417]\ttrain-logloss:0.22711\teval-logloss:0.29811\n",
      "[418]\ttrain-logloss:0.22707\teval-logloss:0.29812\n",
      "[419]\ttrain-logloss:0.22705\teval-logloss:0.29820\n",
      "[420]\ttrain-logloss:0.22692\teval-logloss:0.29831\n",
      "[421]\ttrain-logloss:0.22680\teval-logloss:0.29829\n",
      "[422]\ttrain-logloss:0.22665\teval-logloss:0.29824\n",
      "[423]\ttrain-logloss:0.22650\teval-logloss:0.29816\n",
      "[424]\ttrain-logloss:0.22629\teval-logloss:0.29823\n",
      "[425]\ttrain-logloss:0.22621\teval-logloss:0.29821\n",
      "[426]\ttrain-logloss:0.22601\teval-logloss:0.29830\n",
      "[427]\ttrain-logloss:0.22594\teval-logloss:0.29826\n",
      "[428]\ttrain-logloss:0.22576\teval-logloss:0.29840\n",
      "[429]\ttrain-logloss:0.22566\teval-logloss:0.29842\n",
      "[430]\ttrain-logloss:0.22560\teval-logloss:0.29845\n",
      "[431]\ttrain-logloss:0.22556\teval-logloss:0.29855\n",
      "[432]\ttrain-logloss:0.22547\teval-logloss:0.29869\n",
      "[433]\ttrain-logloss:0.22530\teval-logloss:0.29863\n",
      "[434]\ttrain-logloss:0.22518\teval-logloss:0.29884\n",
      "[435]\ttrain-logloss:0.22508\teval-logloss:0.29878\n",
      "[436]\ttrain-logloss:0.22497\teval-logloss:0.29874\n",
      "[437]\ttrain-logloss:0.22495\teval-logloss:0.29880\n",
      "[438]\ttrain-logloss:0.22480\teval-logloss:0.29895\n",
      "[439]\ttrain-logloss:0.22469\teval-logloss:0.29903\n",
      "[440]\ttrain-logloss:0.22461\teval-logloss:0.29908\n",
      "[441]\ttrain-logloss:0.22443\teval-logloss:0.29918\n",
      "[442]\ttrain-logloss:0.22434\teval-logloss:0.29922\n",
      "[443]\ttrain-logloss:0.22424\teval-logloss:0.29910\n",
      "[444]\ttrain-logloss:0.22409\teval-logloss:0.29912\n",
      "[445]\ttrain-logloss:0.22397\teval-logloss:0.29912\n",
      "[446]\ttrain-logloss:0.22381\teval-logloss:0.29913\n",
      "[447]\ttrain-logloss:0.22370\teval-logloss:0.29928\n",
      "[448]\ttrain-logloss:0.22359\teval-logloss:0.29939\n",
      "[449]\ttrain-logloss:0.22353\teval-logloss:0.29943\n",
      "[450]\ttrain-logloss:0.22336\teval-logloss:0.29955\n",
      "[451]\ttrain-logloss:0.22322\teval-logloss:0.29958\n",
      "[452]\ttrain-logloss:0.22301\teval-logloss:0.29952\n",
      "[453]\ttrain-logloss:0.22285\teval-logloss:0.29953\n",
      "[454]\ttrain-logloss:0.22271\teval-logloss:0.29959\n",
      "[455]\ttrain-logloss:0.22259\teval-logloss:0.29950\n",
      "[456]\ttrain-logloss:0.22248\teval-logloss:0.29951\n",
      "[457]\ttrain-logloss:0.22240\teval-logloss:0.29955\n",
      "[458]\ttrain-logloss:0.22223\teval-logloss:0.29948\n",
      "[459]\ttrain-logloss:0.22214\teval-logloss:0.29961\n",
      "[460]\ttrain-logloss:0.22211\teval-logloss:0.29956\n",
      "[461]\ttrain-logloss:0.22201\teval-logloss:0.29960\n",
      "[462]\ttrain-logloss:0.22190\teval-logloss:0.29970\n",
      "[463]\ttrain-logloss:0.22167\teval-logloss:0.29975\n",
      "[464]\ttrain-logloss:0.22162\teval-logloss:0.29975\n",
      "[465]\ttrain-logloss:0.22145\teval-logloss:0.29971\n",
      "[466]\ttrain-logloss:0.22138\teval-logloss:0.29970\n",
      "[467]\ttrain-logloss:0.22134\teval-logloss:0.29974\n",
      "[468]\ttrain-logloss:0.22132\teval-logloss:0.29980\n",
      "[469]\ttrain-logloss:0.22121\teval-logloss:0.29980\n",
      "[470]\ttrain-logloss:0.22108\teval-logloss:0.29988\n",
      "[471]\ttrain-logloss:0.22102\teval-logloss:0.29991\n",
      "[472]\ttrain-logloss:0.22088\teval-logloss:0.29987\n",
      "[473]\ttrain-logloss:0.22075\teval-logloss:0.29989\n",
      "[474]\ttrain-logloss:0.22061\teval-logloss:0.29983\n",
      "[475]\ttrain-logloss:0.22059\teval-logloss:0.29990\n",
      "[476]\ttrain-logloss:0.22048\teval-logloss:0.29995\n",
      "[477]\ttrain-logloss:0.22047\teval-logloss:0.29997\n",
      "[478]\ttrain-logloss:0.22033\teval-logloss:0.30004\n",
      "[479]\ttrain-logloss:0.22030\teval-logloss:0.29999\n",
      "[480]\ttrain-logloss:0.22019\teval-logloss:0.29991\n",
      "[481]\ttrain-logloss:0.21996\teval-logloss:0.29992\n",
      "[482]\ttrain-logloss:0.21984\teval-logloss:0.30003\n",
      "[483]\ttrain-logloss:0.21975\teval-logloss:0.30005\n",
      "[484]\ttrain-logloss:0.21963\teval-logloss:0.29988\n",
      "[485]\ttrain-logloss:0.21945\teval-logloss:0.29992\n",
      "[486]\ttrain-logloss:0.21935\teval-logloss:0.30008\n",
      "[487]\ttrain-logloss:0.21921\teval-logloss:0.30004\n",
      "[488]\ttrain-logloss:0.21916\teval-logloss:0.30004\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[489]\ttrain-logloss:0.21910\teval-logloss:0.30011\n",
      "[490]\ttrain-logloss:0.21897\teval-logloss:0.29996\n",
      "[491]\ttrain-logloss:0.21884\teval-logloss:0.29995\n",
      "[492]\ttrain-logloss:0.21874\teval-logloss:0.30000\n",
      "[493]\ttrain-logloss:0.21867\teval-logloss:0.30002\n",
      "[494]\ttrain-logloss:0.21850\teval-logloss:0.29989\n",
      "[495]\ttrain-logloss:0.21842\teval-logloss:0.29995\n",
      "[496]\ttrain-logloss:0.21833\teval-logloss:0.29996\n",
      "[497]\ttrain-logloss:0.21826\teval-logloss:0.29991\n",
      "[498]\ttrain-logloss:0.21810\teval-logloss:0.30001\n",
      "[499]\ttrain-logloss:0.21805\teval-logloss:0.29999\n",
      "[500]\ttrain-logloss:0.21792\teval-logloss:0.30013\n",
      "[501]\ttrain-logloss:0.21785\teval-logloss:0.30003\n",
      "[502]\ttrain-logloss:0.21777\teval-logloss:0.30003\n",
      "[503]\ttrain-logloss:0.21771\teval-logloss:0.30001\n",
      "[504]\ttrain-logloss:0.21755\teval-logloss:0.29987\n",
      "[505]\ttrain-logloss:0.21751\teval-logloss:0.29988\n",
      "[506]\ttrain-logloss:0.21743\teval-logloss:0.29992\n",
      "[507]\ttrain-logloss:0.21742\teval-logloss:0.30000\n",
      "[508]\ttrain-logloss:0.21740\teval-logloss:0.30003\n",
      "[509]\ttrain-logloss:0.21725\teval-logloss:0.29995\n",
      "[510]\ttrain-logloss:0.21716\teval-logloss:0.29994\n",
      "[511]\ttrain-logloss:0.21712\teval-logloss:0.29992\n",
      "[512]\ttrain-logloss:0.21705\teval-logloss:0.30001\n",
      "[513]\ttrain-logloss:0.21692\teval-logloss:0.29994\n",
      "[514]\ttrain-logloss:0.21687\teval-logloss:0.29996\n",
      "[515]\ttrain-logloss:0.21685\teval-logloss:0.29998\n",
      "[516]\ttrain-logloss:0.21679\teval-logloss:0.30004\n",
      "[517]\ttrain-logloss:0.21675\teval-logloss:0.30010\n",
      "[518]\ttrain-logloss:0.21664\teval-logloss:0.30010\n",
      "[519]\ttrain-logloss:0.21654\teval-logloss:0.30019\n",
      "[520]\ttrain-logloss:0.21647\teval-logloss:0.30027\n",
      "[521]\ttrain-logloss:0.21644\teval-logloss:0.30033\n",
      "[522]\ttrain-logloss:0.21631\teval-logloss:0.30040\n",
      "[523]\ttrain-logloss:0.21625\teval-logloss:0.30036\n",
      "[524]\ttrain-logloss:0.21618\teval-logloss:0.30040\n",
      "[525]\ttrain-logloss:0.21600\teval-logloss:0.30038\n",
      "[526]\ttrain-logloss:0.21598\teval-logloss:0.30048\n",
      "[527]\ttrain-logloss:0.21585\teval-logloss:0.30058\n",
      "[528]\ttrain-logloss:0.21571\teval-logloss:0.30061\n",
      "[529]\ttrain-logloss:0.21560\teval-logloss:0.30067\n",
      "[530]\ttrain-logloss:0.21549\teval-logloss:0.30076\n",
      "[531]\ttrain-logloss:0.21536\teval-logloss:0.30085\n",
      "[532]\ttrain-logloss:0.21523\teval-logloss:0.30090\n",
      "[533]\ttrain-logloss:0.21518\teval-logloss:0.30088\n",
      "[534]\ttrain-logloss:0.21512\teval-logloss:0.30096\n",
      "[535]\ttrain-logloss:0.21507\teval-logloss:0.30100\n",
      "[536]\ttrain-logloss:0.21496\teval-logloss:0.30095\n",
      "[537]\ttrain-logloss:0.21493\teval-logloss:0.30097\n",
      "[538]\ttrain-logloss:0.21480\teval-logloss:0.30098\n",
      "[539]\ttrain-logloss:0.21473\teval-logloss:0.30110\n",
      "[540]\ttrain-logloss:0.21465\teval-logloss:0.30114\n",
      "[541]\ttrain-logloss:0.21456\teval-logloss:0.30107\n",
      "[542]\ttrain-logloss:0.21444\teval-logloss:0.30108\n",
      "[543]\ttrain-logloss:0.21440\teval-logloss:0.30107\n",
      "[544]\ttrain-logloss:0.21436\teval-logloss:0.30110\n",
      "[545]\ttrain-logloss:0.21421\teval-logloss:0.30115\n",
      "[546]\ttrain-logloss:0.21416\teval-logloss:0.30114\n",
      "[547]\ttrain-logloss:0.21406\teval-logloss:0.30118\n",
      "[548]\ttrain-logloss:0.21394\teval-logloss:0.30128\n",
      "[549]\ttrain-logloss:0.21384\teval-logloss:0.30144\n",
      "[550]\ttrain-logloss:0.21380\teval-logloss:0.30147\n",
      "[551]\ttrain-logloss:0.21373\teval-logloss:0.30149\n",
      "[552]\ttrain-logloss:0.21371\teval-logloss:0.30155\n",
      "[553]\ttrain-logloss:0.21369\teval-logloss:0.30156\n",
      "[554]\ttrain-logloss:0.21365\teval-logloss:0.30161\n",
      "[555]\ttrain-logloss:0.21353\teval-logloss:0.30162\n",
      "[556]\ttrain-logloss:0.21341\teval-logloss:0.30165\n",
      "[557]\ttrain-logloss:0.21335\teval-logloss:0.30160\n",
      "[558]\ttrain-logloss:0.21325\teval-logloss:0.30164\n",
      "[559]\ttrain-logloss:0.21315\teval-logloss:0.30168\n",
      "[560]\ttrain-logloss:0.21309\teval-logloss:0.30174\n",
      "[561]\ttrain-logloss:0.21300\teval-logloss:0.30184\n",
      "[562]\ttrain-logloss:0.21292\teval-logloss:0.30184\n",
      "[563]\ttrain-logloss:0.21284\teval-logloss:0.30186\n",
      "[564]\ttrain-logloss:0.21274\teval-logloss:0.30188\n",
      "[565]\ttrain-logloss:0.21264\teval-logloss:0.30194\n",
      "[566]\ttrain-logloss:0.21256\teval-logloss:0.30205\n",
      "[567]\ttrain-logloss:0.21249\teval-logloss:0.30203\n",
      "[568]\ttrain-logloss:0.21244\teval-logloss:0.30203\n",
      "[569]\ttrain-logloss:0.21240\teval-logloss:0.30203\n",
      "[570]\ttrain-logloss:0.21240\teval-logloss:0.30205\n",
      "[571]\ttrain-logloss:0.21236\teval-logloss:0.30204\n",
      "[572]\ttrain-logloss:0.21234\teval-logloss:0.30207\n",
      "[573]\ttrain-logloss:0.21224\teval-logloss:0.30217\n",
      "[574]\ttrain-logloss:0.21205\teval-logloss:0.30220\n",
      "[575]\ttrain-logloss:0.21199\teval-logloss:0.30221\n",
      "[576]\ttrain-logloss:0.21187\teval-logloss:0.30215\n",
      "[577]\ttrain-logloss:0.21176\teval-logloss:0.30212\n",
      "[578]\ttrain-logloss:0.21164\teval-logloss:0.30216\n",
      "[579]\ttrain-logloss:0.21159\teval-logloss:0.30220\n",
      "[580]\ttrain-logloss:0.21147\teval-logloss:0.30224\n",
      "[581]\ttrain-logloss:0.21139\teval-logloss:0.30227\n",
      "[582]\ttrain-logloss:0.21138\teval-logloss:0.30228\n",
      "[583]\ttrain-logloss:0.21135\teval-logloss:0.30229\n",
      "[584]\ttrain-logloss:0.21134\teval-logloss:0.30230\n",
      "[585]\ttrain-logloss:0.21124\teval-logloss:0.30234\n",
      "[586]\ttrain-logloss:0.21111\teval-logloss:0.30235\n",
      "[587]\ttrain-logloss:0.21102\teval-logloss:0.30240\n",
      "[588]\ttrain-logloss:0.21098\teval-logloss:0.30240\n",
      "[589]\ttrain-logloss:0.21097\teval-logloss:0.30247\n",
      "[590]\ttrain-logloss:0.21085\teval-logloss:0.30261\n",
      "[591]\ttrain-logloss:0.21075\teval-logloss:0.30268\n",
      "[592]\ttrain-logloss:0.21063\teval-logloss:0.30262\n",
      "[593]\ttrain-logloss:0.21051\teval-logloss:0.30269\n",
      "[594]\ttrain-logloss:0.21050\teval-logloss:0.30270\n",
      "[595]\ttrain-logloss:0.21047\teval-logloss:0.30269\n",
      "[596]\ttrain-logloss:0.21038\teval-logloss:0.30263\n",
      "[597]\ttrain-logloss:0.21029\teval-logloss:0.30263\n",
      "[598]\ttrain-logloss:0.21019\teval-logloss:0.30261\n",
      "[599]\ttrain-logloss:0.21015\teval-logloss:0.30263\n",
      "[600]\ttrain-logloss:0.21010\teval-logloss:0.30265\n",
      "[601]\ttrain-logloss:0.20998\teval-logloss:0.30253\n",
      "[602]\ttrain-logloss:0.20991\teval-logloss:0.30249\n",
      "[603]\ttrain-logloss:0.20984\teval-logloss:0.30255\n",
      "[604]\ttrain-logloss:0.20973\teval-logloss:0.30257\n",
      "[605]\ttrain-logloss:0.20972\teval-logloss:0.30259\n",
      "[606]\ttrain-logloss:0.20964\teval-logloss:0.30254\n",
      "[607]\ttrain-logloss:0.20958\teval-logloss:0.30251\n",
      "[608]\ttrain-logloss:0.20953\teval-logloss:0.30246\n",
      "[609]\ttrain-logloss:0.20952\teval-logloss:0.30249\n",
      "[610]\ttrain-logloss:0.20952\teval-logloss:0.30253\n",
      "[611]\ttrain-logloss:0.20943\teval-logloss:0.30252\n",
      "[612]\ttrain-logloss:0.20926\teval-logloss:0.30246\n",
      "[613]\ttrain-logloss:0.20916\teval-logloss:0.30247\n",
      "[614]\ttrain-logloss:0.20909\teval-logloss:0.30246\n",
      "[615]\ttrain-logloss:0.20895\teval-logloss:0.30247\n",
      "[616]\ttrain-logloss:0.20887\teval-logloss:0.30250\n",
      "[617]\ttrain-logloss:0.20880\teval-logloss:0.30244\n",
      "[618]\ttrain-logloss:0.20871\teval-logloss:0.30243\n",
      "[619]\ttrain-logloss:0.20867\teval-logloss:0.30243\n",
      "[620]\ttrain-logloss:0.20849\teval-logloss:0.30243\n",
      "[621]\ttrain-logloss:0.20840\teval-logloss:0.30246\n",
      "[622]\ttrain-logloss:0.20821\teval-logloss:0.30247\n",
      "[623]\ttrain-logloss:0.20812\teval-logloss:0.30248\n",
      "[624]\ttrain-logloss:0.20804\teval-logloss:0.30252\n",
      "[625]\ttrain-logloss:0.20794\teval-logloss:0.30254\n",
      "[626]\ttrain-logloss:0.20786\teval-logloss:0.30257\n",
      "[627]\ttrain-logloss:0.20782\teval-logloss:0.30256\n",
      "[628]\ttrain-logloss:0.20777\teval-logloss:0.30256\n",
      "[629]\ttrain-logloss:0.20768\teval-logloss:0.30259\n",
      "[630]\ttrain-logloss:0.20762\teval-logloss:0.30265\n",
      "[631]\ttrain-logloss:0.20753\teval-logloss:0.30275\n",
      "[632]\ttrain-logloss:0.20751\teval-logloss:0.30279\n",
      "[633]\ttrain-logloss:0.20748\teval-logloss:0.30283\n",
      "[634]\ttrain-logloss:0.20730\teval-logloss:0.30279\n",
      "[635]\ttrain-logloss:0.20715\teval-logloss:0.30287\n",
      "[636]\ttrain-logloss:0.20698\teval-logloss:0.30301\n",
      "[637]\ttrain-logloss:0.20697\teval-logloss:0.30303\n",
      "[638]\ttrain-logloss:0.20695\teval-logloss:0.30304\n",
      "[639]\ttrain-logloss:0.20689\teval-logloss:0.30305\n",
      "[640]\ttrain-logloss:0.20685\teval-logloss:0.30310\n",
      "[641]\ttrain-logloss:0.20682\teval-logloss:0.30312\n",
      "[642]\ttrain-logloss:0.20678\teval-logloss:0.30303\n",
      "[643]\ttrain-logloss:0.20673\teval-logloss:0.30309\n",
      "[644]\ttrain-logloss:0.20665\teval-logloss:0.30311\n",
      "[645]\ttrain-logloss:0.20658\teval-logloss:0.30312\n",
      "[646]\ttrain-logloss:0.20643\teval-logloss:0.30318\n",
      "[647]\ttrain-logloss:0.20632\teval-logloss:0.30313\n",
      "[648]\ttrain-logloss:0.20624\teval-logloss:0.30311\n",
      "[649]\ttrain-logloss:0.20606\teval-logloss:0.30316\n",
      "[650]\ttrain-logloss:0.20590\teval-logloss:0.30316\n",
      "[651]\ttrain-logloss:0.20578\teval-logloss:0.30317\n",
      "[652]\ttrain-logloss:0.20559\teval-logloss:0.30302\n",
      "[653]\ttrain-logloss:0.20550\teval-logloss:0.30298\n",
      "[654]\ttrain-logloss:0.20545\teval-logloss:0.30291\n",
      "[655]\ttrain-logloss:0.20534\teval-logloss:0.30296\n",
      "[656]\ttrain-logloss:0.20528\teval-logloss:0.30295\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[657]\ttrain-logloss:0.20527\teval-logloss:0.30298\n",
      "[658]\ttrain-logloss:0.20511\teval-logloss:0.30300\n",
      "[659]\ttrain-logloss:0.20500\teval-logloss:0.30299\n",
      "[660]\ttrain-logloss:0.20496\teval-logloss:0.30308\n",
      "[661]\ttrain-logloss:0.20494\teval-logloss:0.30309\n",
      "[662]\ttrain-logloss:0.20484\teval-logloss:0.30300\n",
      "[663]\ttrain-logloss:0.20478\teval-logloss:0.30315\n",
      "[664]\ttrain-logloss:0.20470\teval-logloss:0.30312\n",
      "[665]\ttrain-logloss:0.20468\teval-logloss:0.30317\n",
      "[666]\ttrain-logloss:0.20464\teval-logloss:0.30319\n",
      "[667]\ttrain-logloss:0.20452\teval-logloss:0.30315\n",
      "[668]\ttrain-logloss:0.20440\teval-logloss:0.30319\n",
      "[669]\ttrain-logloss:0.20432\teval-logloss:0.30327\n",
      "[670]\ttrain-logloss:0.20427\teval-logloss:0.30328\n",
      "[671]\ttrain-logloss:0.20419\teval-logloss:0.30328\n",
      "[672]\ttrain-logloss:0.20408\teval-logloss:0.30331\n",
      "[673]\ttrain-logloss:0.20403\teval-logloss:0.30329\n",
      "[674]\ttrain-logloss:0.20398\teval-logloss:0.30329\n",
      "[675]\ttrain-logloss:0.20388\teval-logloss:0.30332\n",
      "[676]\ttrain-logloss:0.20376\teval-logloss:0.30338\n",
      "[677]\ttrain-logloss:0.20365\teval-logloss:0.30346\n",
      "[678]\ttrain-logloss:0.20355\teval-logloss:0.30348\n",
      "[679]\ttrain-logloss:0.20342\teval-logloss:0.30346\n",
      "[680]\ttrain-logloss:0.20336\teval-logloss:0.30355\n",
      "[681]\ttrain-logloss:0.20333\teval-logloss:0.30354\n",
      "[682]\ttrain-logloss:0.20328\teval-logloss:0.30354\n",
      "[683]\ttrain-logloss:0.20320\teval-logloss:0.30359\n",
      "[684]\ttrain-logloss:0.20314\teval-logloss:0.30360\n",
      "[685]\ttrain-logloss:0.20307\teval-logloss:0.30364\n",
      "[686]\ttrain-logloss:0.20302\teval-logloss:0.30368\n",
      "[687]\ttrain-logloss:0.20294\teval-logloss:0.30369\n",
      "[688]\ttrain-logloss:0.20292\teval-logloss:0.30371\n",
      "[689]\ttrain-logloss:0.20284\teval-logloss:0.30369\n",
      "[690]\ttrain-logloss:0.20275\teval-logloss:0.30374\n",
      "[691]\ttrain-logloss:0.20268\teval-logloss:0.30372\n",
      "[692]\ttrain-logloss:0.20254\teval-logloss:0.30373\n",
      "[693]\ttrain-logloss:0.20246\teval-logloss:0.30377\n",
      "[694]\ttrain-logloss:0.20234\teval-logloss:0.30384\n",
      "[695]\ttrain-logloss:0.20225\teval-logloss:0.30384\n",
      "[696]\ttrain-logloss:0.20217\teval-logloss:0.30386\n",
      "[697]\ttrain-logloss:0.20211\teval-logloss:0.30383\n",
      "[698]\ttrain-logloss:0.20203\teval-logloss:0.30388\n",
      "[699]\ttrain-logloss:0.20196\teval-logloss:0.30394\n",
      "[700]\ttrain-logloss:0.20186\teval-logloss:0.30392\n",
      "[701]\ttrain-logloss:0.20177\teval-logloss:0.30394\n",
      "[702]\ttrain-logloss:0.20166\teval-logloss:0.30389\n",
      "[703]\ttrain-logloss:0.20161\teval-logloss:0.30393\n",
      "[704]\ttrain-logloss:0.20156\teval-logloss:0.30384\n",
      "[705]\ttrain-logloss:0.20150\teval-logloss:0.30386\n",
      "[706]\ttrain-logloss:0.20142\teval-logloss:0.30403\n",
      "[707]\ttrain-logloss:0.20131\teval-logloss:0.30410\n",
      "[708]\ttrain-logloss:0.20124\teval-logloss:0.30407\n",
      "[709]\ttrain-logloss:0.20118\teval-logloss:0.30410\n",
      "[710]\ttrain-logloss:0.20107\teval-logloss:0.30415\n",
      "[711]\ttrain-logloss:0.20095\teval-logloss:0.30422\n",
      "[712]\ttrain-logloss:0.20091\teval-logloss:0.30425\n",
      "[713]\ttrain-logloss:0.20085\teval-logloss:0.30424\n",
      "[714]\ttrain-logloss:0.20072\teval-logloss:0.30433\n",
      "[715]\ttrain-logloss:0.20058\teval-logloss:0.30428\n",
      "[716]\ttrain-logloss:0.20048\teval-logloss:0.30427\n",
      "[717]\ttrain-logloss:0.20044\teval-logloss:0.30430\n",
      "[718]\ttrain-logloss:0.20036\teval-logloss:0.30429\n",
      "[719]\ttrain-logloss:0.20027\teval-logloss:0.30442\n",
      "[720]\ttrain-logloss:0.20021\teval-logloss:0.30445\n",
      "[721]\ttrain-logloss:0.20017\teval-logloss:0.30447\n",
      "[722]\ttrain-logloss:0.20008\teval-logloss:0.30454\n",
      "[723]\ttrain-logloss:0.20001\teval-logloss:0.30455\n",
      "[724]\ttrain-logloss:0.19998\teval-logloss:0.30453\n",
      "[725]\ttrain-logloss:0.19987\teval-logloss:0.30453\n",
      "[726]\ttrain-logloss:0.19985\teval-logloss:0.30459\n",
      "[727]\ttrain-logloss:0.19983\teval-logloss:0.30458\n",
      "[728]\ttrain-logloss:0.19976\teval-logloss:0.30456\n",
      "[729]\ttrain-logloss:0.19967\teval-logloss:0.30455\n",
      "[730]\ttrain-logloss:0.19965\teval-logloss:0.30459\n",
      "[731]\ttrain-logloss:0.19963\teval-logloss:0.30462\n",
      "[732]\ttrain-logloss:0.19955\teval-logloss:0.30464\n",
      "[733]\ttrain-logloss:0.19947\teval-logloss:0.30463\n",
      "[734]\ttrain-logloss:0.19932\teval-logloss:0.30466\n",
      "[735]\ttrain-logloss:0.19924\teval-logloss:0.30462\n",
      "[736]\ttrain-logloss:0.19910\teval-logloss:0.30474\n",
      "[737]\ttrain-logloss:0.19894\teval-logloss:0.30483\n",
      "[738]\ttrain-logloss:0.19886\teval-logloss:0.30485\n",
      "[739]\ttrain-logloss:0.19876\teval-logloss:0.30486\n",
      "[740]\ttrain-logloss:0.19873\teval-logloss:0.30497\n",
      "[741]\ttrain-logloss:0.19870\teval-logloss:0.30494\n",
      "[742]\ttrain-logloss:0.19853\teval-logloss:0.30497\n",
      "[743]\ttrain-logloss:0.19842\teval-logloss:0.30498\n",
      "[744]\ttrain-logloss:0.19839\teval-logloss:0.30506\n",
      "[745]\ttrain-logloss:0.19823\teval-logloss:0.30519\n",
      "[746]\ttrain-logloss:0.19817\teval-logloss:0.30525\n",
      "[747]\ttrain-logloss:0.19809\teval-logloss:0.30520\n",
      "[748]\ttrain-logloss:0.19796\teval-logloss:0.30521\n",
      "[749]\ttrain-logloss:0.19789\teval-logloss:0.30529\n",
      "[750]\ttrain-logloss:0.19784\teval-logloss:0.30539\n",
      "[751]\ttrain-logloss:0.19776\teval-logloss:0.30535\n",
      "[752]\ttrain-logloss:0.19771\teval-logloss:0.30530\n",
      "[753]\ttrain-logloss:0.19770\teval-logloss:0.30533\n",
      "[754]\ttrain-logloss:0.19763\teval-logloss:0.30529\n",
      "[755]\ttrain-logloss:0.19760\teval-logloss:0.30533\n",
      "[756]\ttrain-logloss:0.19750\teval-logloss:0.30540\n",
      "[757]\ttrain-logloss:0.19739\teval-logloss:0.30545\n",
      "[758]\ttrain-logloss:0.19734\teval-logloss:0.30543\n",
      "[759]\ttrain-logloss:0.19724\teval-logloss:0.30550\n",
      "[760]\ttrain-logloss:0.19717\teval-logloss:0.30561\n",
      "[761]\ttrain-logloss:0.19710\teval-logloss:0.30562\n",
      "[762]\ttrain-logloss:0.19700\teval-logloss:0.30573\n",
      "[763]\ttrain-logloss:0.19700\teval-logloss:0.30574\n",
      "[764]\ttrain-logloss:0.19693\teval-logloss:0.30573\n",
      "[765]\ttrain-logloss:0.19689\teval-logloss:0.30581\n",
      "[766]\ttrain-logloss:0.19688\teval-logloss:0.30585\n",
      "[767]\ttrain-logloss:0.19682\teval-logloss:0.30587\n",
      "[768]\ttrain-logloss:0.19679\teval-logloss:0.30590\n",
      "[769]\ttrain-logloss:0.19678\teval-logloss:0.30592\n",
      "[770]\ttrain-logloss:0.19677\teval-logloss:0.30592\n",
      "[771]\ttrain-logloss:0.19670\teval-logloss:0.30593\n",
      "[772]\ttrain-logloss:0.19660\teval-logloss:0.30593\n",
      "[773]\ttrain-logloss:0.19654\teval-logloss:0.30597\n",
      "[774]\ttrain-logloss:0.19644\teval-logloss:0.30604\n",
      "[775]\ttrain-logloss:0.19640\teval-logloss:0.30608\n",
      "[776]\ttrain-logloss:0.19638\teval-logloss:0.30610\n",
      "[777]\ttrain-logloss:0.19626\teval-logloss:0.30608\n",
      "[778]\ttrain-logloss:0.19613\teval-logloss:0.30631\n",
      "[779]\ttrain-logloss:0.19606\teval-logloss:0.30629\n",
      "[780]\ttrain-logloss:0.19600\teval-logloss:0.30627\n",
      "[781]\ttrain-logloss:0.19589\teval-logloss:0.30619\n",
      "[782]\ttrain-logloss:0.19578\teval-logloss:0.30631\n",
      "[783]\ttrain-logloss:0.19565\teval-logloss:0.30635\n",
      "[784]\ttrain-logloss:0.19554\teval-logloss:0.30626\n",
      "[785]\ttrain-logloss:0.19543\teval-logloss:0.30617\n",
      "[786]\ttrain-logloss:0.19533\teval-logloss:0.30610\n",
      "[787]\ttrain-logloss:0.19525\teval-logloss:0.30617\n",
      "[788]\ttrain-logloss:0.19517\teval-logloss:0.30617\n",
      "[789]\ttrain-logloss:0.19505\teval-logloss:0.30611\n",
      "[790]\ttrain-logloss:0.19501\teval-logloss:0.30618\n",
      "[791]\ttrain-logloss:0.19497\teval-logloss:0.30617\n",
      "[792]\ttrain-logloss:0.19485\teval-logloss:0.30609\n",
      "[793]\ttrain-logloss:0.19474\teval-logloss:0.30603\n",
      "[794]\ttrain-logloss:0.19466\teval-logloss:0.30599\n",
      "[795]\ttrain-logloss:0.19466\teval-logloss:0.30597\n",
      "[796]\ttrain-logloss:0.19465\teval-logloss:0.30601\n",
      "[797]\ttrain-logloss:0.19454\teval-logloss:0.30620\n",
      "[798]\ttrain-logloss:0.19450\teval-logloss:0.30617\n",
      "[799]\ttrain-logloss:0.19444\teval-logloss:0.30614\n",
      "[800]\ttrain-logloss:0.19440\teval-logloss:0.30611\n",
      "[801]\ttrain-logloss:0.19437\teval-logloss:0.30617\n",
      "[802]\ttrain-logloss:0.19436\teval-logloss:0.30616\n",
      "[803]\ttrain-logloss:0.19435\teval-logloss:0.30614\n",
      "[804]\ttrain-logloss:0.19434\teval-logloss:0.30616\n",
      "[805]\ttrain-logloss:0.19429\teval-logloss:0.30633\n",
      "[806]\ttrain-logloss:0.19418\teval-logloss:0.30637\n",
      "[807]\ttrain-logloss:0.19410\teval-logloss:0.30635\n",
      "[808]\ttrain-logloss:0.19398\teval-logloss:0.30635\n",
      "[809]\ttrain-logloss:0.19395\teval-logloss:0.30639\n",
      "[810]\ttrain-logloss:0.19395\teval-logloss:0.30638\n",
      "[811]\ttrain-logloss:0.19384\teval-logloss:0.30625\n",
      "[812]\ttrain-logloss:0.19374\teval-logloss:0.30634\n",
      "[813]\ttrain-logloss:0.19357\teval-logloss:0.30618\n",
      "[814]\ttrain-logloss:0.19352\teval-logloss:0.30612\n",
      "[815]\ttrain-logloss:0.19337\teval-logloss:0.30611\n",
      "[816]\ttrain-logloss:0.19328\teval-logloss:0.30616\n",
      "[817]\ttrain-logloss:0.19321\teval-logloss:0.30615\n",
      "[818]\ttrain-logloss:0.19315\teval-logloss:0.30611\n",
      "[819]\ttrain-logloss:0.19306\teval-logloss:0.30612\n",
      "[820]\ttrain-logloss:0.19303\teval-logloss:0.30613\n",
      "[821]\ttrain-logloss:0.19300\teval-logloss:0.30612\n",
      "[822]\ttrain-logloss:0.19288\teval-logloss:0.30600\n",
      "[823]\ttrain-logloss:0.19284\teval-logloss:0.30603\n",
      "[824]\ttrain-logloss:0.19280\teval-logloss:0.30604\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[825]\ttrain-logloss:0.19269\teval-logloss:0.30611\n",
      "[826]\ttrain-logloss:0.19261\teval-logloss:0.30618\n",
      "[827]\ttrain-logloss:0.19254\teval-logloss:0.30624\n",
      "[828]\ttrain-logloss:0.19251\teval-logloss:0.30623\n",
      "[829]\ttrain-logloss:0.19250\teval-logloss:0.30623\n",
      "[830]\ttrain-logloss:0.19249\teval-logloss:0.30626\n",
      "[831]\ttrain-logloss:0.19244\teval-logloss:0.30636\n",
      "[832]\ttrain-logloss:0.19238\teval-logloss:0.30644\n",
      "[833]\ttrain-logloss:0.19226\teval-logloss:0.30650\n",
      "[834]\ttrain-logloss:0.19218\teval-logloss:0.30643\n",
      "[835]\ttrain-logloss:0.19211\teval-logloss:0.30632\n",
      "[836]\ttrain-logloss:0.19211\teval-logloss:0.30634\n",
      "[837]\ttrain-logloss:0.19203\teval-logloss:0.30651\n",
      "[838]\ttrain-logloss:0.19196\teval-logloss:0.30645\n",
      "[839]\ttrain-logloss:0.19187\teval-logloss:0.30649\n",
      "[840]\ttrain-logloss:0.19166\teval-logloss:0.30648\n",
      "[841]\ttrain-logloss:0.19161\teval-logloss:0.30656\n",
      "[842]\ttrain-logloss:0.19154\teval-logloss:0.30656\n",
      "[843]\ttrain-logloss:0.19153\teval-logloss:0.30658\n",
      "[844]\ttrain-logloss:0.19152\teval-logloss:0.30662\n",
      "[845]\ttrain-logloss:0.19143\teval-logloss:0.30659\n",
      "[846]\ttrain-logloss:0.19132\teval-logloss:0.30653\n",
      "[847]\ttrain-logloss:0.19131\teval-logloss:0.30659\n",
      "[848]\ttrain-logloss:0.19126\teval-logloss:0.30660\n",
      "[849]\ttrain-logloss:0.19111\teval-logloss:0.30653\n",
      "[850]\ttrain-logloss:0.19106\teval-logloss:0.30653\n",
      "[851]\ttrain-logloss:0.19099\teval-logloss:0.30651\n",
      "[852]\ttrain-logloss:0.19098\teval-logloss:0.30650\n",
      "[853]\ttrain-logloss:0.19089\teval-logloss:0.30656\n",
      "[854]\ttrain-logloss:0.19073\teval-logloss:0.30651\n",
      "[855]\ttrain-logloss:0.19066\teval-logloss:0.30642\n",
      "[856]\ttrain-logloss:0.19063\teval-logloss:0.30642\n",
      "[857]\ttrain-logloss:0.19057\teval-logloss:0.30644\n",
      "[858]\ttrain-logloss:0.19051\teval-logloss:0.30643\n",
      "[859]\ttrain-logloss:0.19042\teval-logloss:0.30647\n",
      "[860]\ttrain-logloss:0.19037\teval-logloss:0.30652\n",
      "[861]\ttrain-logloss:0.19028\teval-logloss:0.30652\n",
      "[862]\ttrain-logloss:0.19020\teval-logloss:0.30652\n",
      "[863]\ttrain-logloss:0.19018\teval-logloss:0.30655\n",
      "[864]\ttrain-logloss:0.19010\teval-logloss:0.30652\n",
      "[865]\ttrain-logloss:0.19004\teval-logloss:0.30651\n",
      "[866]\ttrain-logloss:0.18989\teval-logloss:0.30641\n",
      "[867]\ttrain-logloss:0.18978\teval-logloss:0.30648\n",
      "[868]\ttrain-logloss:0.18975\teval-logloss:0.30648\n",
      "[869]\ttrain-logloss:0.18974\teval-logloss:0.30651\n",
      "[870]\ttrain-logloss:0.18968\teval-logloss:0.30654\n",
      "[871]\ttrain-logloss:0.18963\teval-logloss:0.30651\n",
      "[872]\ttrain-logloss:0.18956\teval-logloss:0.30654\n",
      "[873]\ttrain-logloss:0.18942\teval-logloss:0.30649\n",
      "[874]\ttrain-logloss:0.18935\teval-logloss:0.30646\n",
      "[875]\ttrain-logloss:0.18922\teval-logloss:0.30644\n",
      "[876]\ttrain-logloss:0.18909\teval-logloss:0.30637\n",
      "[877]\ttrain-logloss:0.18902\teval-logloss:0.30640\n",
      "[878]\ttrain-logloss:0.18893\teval-logloss:0.30647\n",
      "[879]\ttrain-logloss:0.18884\teval-logloss:0.30653\n",
      "[880]\ttrain-logloss:0.18871\teval-logloss:0.30653\n",
      "[881]\ttrain-logloss:0.18862\teval-logloss:0.30652\n",
      "[882]\ttrain-logloss:0.18857\teval-logloss:0.30659\n",
      "[883]\ttrain-logloss:0.18846\teval-logloss:0.30652\n",
      "[884]\ttrain-logloss:0.18842\teval-logloss:0.30644\n",
      "[885]\ttrain-logloss:0.18831\teval-logloss:0.30639\n",
      "[886]\ttrain-logloss:0.18824\teval-logloss:0.30639\n",
      "[887]\ttrain-logloss:0.18818\teval-logloss:0.30638\n",
      "[888]\ttrain-logloss:0.18818\teval-logloss:0.30643\n",
      "[889]\ttrain-logloss:0.18813\teval-logloss:0.30643\n",
      "[890]\ttrain-logloss:0.18809\teval-logloss:0.30650\n",
      "[891]\ttrain-logloss:0.18805\teval-logloss:0.30649\n",
      "[892]\ttrain-logloss:0.18801\teval-logloss:0.30646\n",
      "[893]\ttrain-logloss:0.18796\teval-logloss:0.30643\n",
      "[894]\ttrain-logloss:0.18786\teval-logloss:0.30647\n",
      "[895]\ttrain-logloss:0.18781\teval-logloss:0.30644\n",
      "[896]\ttrain-logloss:0.18777\teval-logloss:0.30645\n",
      "[897]\ttrain-logloss:0.18776\teval-logloss:0.30648\n",
      "[898]\ttrain-logloss:0.18770\teval-logloss:0.30646\n",
      "[899]\ttrain-logloss:0.18765\teval-logloss:0.30643\n",
      "[900]\ttrain-logloss:0.18759\teval-logloss:0.30635\n",
      "[901]\ttrain-logloss:0.18758\teval-logloss:0.30634\n",
      "[902]\ttrain-logloss:0.18756\teval-logloss:0.30634\n",
      "[903]\ttrain-logloss:0.18742\teval-logloss:0.30632\n",
      "[904]\ttrain-logloss:0.18734\teval-logloss:0.30632\n",
      "[905]\ttrain-logloss:0.18734\teval-logloss:0.30632\n",
      "[906]\ttrain-logloss:0.18732\teval-logloss:0.30628\n",
      "[907]\ttrain-logloss:0.18732\teval-logloss:0.30630\n",
      "[908]\ttrain-logloss:0.18731\teval-logloss:0.30628\n",
      "[909]\ttrain-logloss:0.18730\teval-logloss:0.30631\n",
      "[910]\ttrain-logloss:0.18729\teval-logloss:0.30632\n",
      "[911]\ttrain-logloss:0.18728\teval-logloss:0.30629\n",
      "[912]\ttrain-logloss:0.18718\teval-logloss:0.30625\n",
      "[913]\ttrain-logloss:0.18712\teval-logloss:0.30622\n",
      "[914]\ttrain-logloss:0.18708\teval-logloss:0.30628\n",
      "[915]\ttrain-logloss:0.18707\teval-logloss:0.30628\n",
      "[916]\ttrain-logloss:0.18704\teval-logloss:0.30632\n",
      "[917]\ttrain-logloss:0.18696\teval-logloss:0.30627\n",
      "[918]\ttrain-logloss:0.18691\teval-logloss:0.30623\n",
      "[919]\ttrain-logloss:0.18678\teval-logloss:0.30632\n",
      "[920]\ttrain-logloss:0.18675\teval-logloss:0.30638\n",
      "[921]\ttrain-logloss:0.18669\teval-logloss:0.30642\n",
      "[922]\ttrain-logloss:0.18659\teval-logloss:0.30644\n",
      "[923]\ttrain-logloss:0.18645\teval-logloss:0.30642\n",
      "[924]\ttrain-logloss:0.18636\teval-logloss:0.30652\n",
      "[925]\ttrain-logloss:0.18626\teval-logloss:0.30648\n",
      "[926]\ttrain-logloss:0.18615\teval-logloss:0.30654\n",
      "[927]\ttrain-logloss:0.18607\teval-logloss:0.30651\n",
      "[928]\ttrain-logloss:0.18601\teval-logloss:0.30647\n",
      "[929]\ttrain-logloss:0.18593\teval-logloss:0.30649\n",
      "[930]\ttrain-logloss:0.18579\teval-logloss:0.30653\n",
      "[931]\ttrain-logloss:0.18566\teval-logloss:0.30651\n",
      "[932]\ttrain-logloss:0.18565\teval-logloss:0.30650\n",
      "[933]\ttrain-logloss:0.18556\teval-logloss:0.30653\n",
      "[934]\ttrain-logloss:0.18540\teval-logloss:0.30667\n",
      "[935]\ttrain-logloss:0.18529\teval-logloss:0.30667\n",
      "[936]\ttrain-logloss:0.18515\teval-logloss:0.30676\n",
      "[937]\ttrain-logloss:0.18512\teval-logloss:0.30681\n",
      "[938]\ttrain-logloss:0.18504\teval-logloss:0.30682\n",
      "[939]\ttrain-logloss:0.18496\teval-logloss:0.30684\n",
      "[940]\ttrain-logloss:0.18488\teval-logloss:0.30683\n",
      "[941]\ttrain-logloss:0.18478\teval-logloss:0.30679\n",
      "[942]\ttrain-logloss:0.18470\teval-logloss:0.30675\n",
      "[943]\ttrain-logloss:0.18462\teval-logloss:0.30679\n",
      "[944]\ttrain-logloss:0.18455\teval-logloss:0.30677\n",
      "[945]\ttrain-logloss:0.18444\teval-logloss:0.30675\n",
      "[946]\ttrain-logloss:0.18438\teval-logloss:0.30686\n",
      "[947]\ttrain-logloss:0.18432\teval-logloss:0.30692\n",
      "[948]\ttrain-logloss:0.18427\teval-logloss:0.30699\n",
      "[949]\ttrain-logloss:0.18423\teval-logloss:0.30696\n",
      "[950]\ttrain-logloss:0.18417\teval-logloss:0.30703\n",
      "[951]\ttrain-logloss:0.18411\teval-logloss:0.30711\n",
      "[952]\ttrain-logloss:0.18404\teval-logloss:0.30712\n",
      "[953]\ttrain-logloss:0.18403\teval-logloss:0.30716\n",
      "[954]\ttrain-logloss:0.18396\teval-logloss:0.30717\n",
      "[955]\ttrain-logloss:0.18394\teval-logloss:0.30715\n",
      "[956]\ttrain-logloss:0.18393\teval-logloss:0.30719\n",
      "[957]\ttrain-logloss:0.18385\teval-logloss:0.30714\n",
      "[958]\ttrain-logloss:0.18376\teval-logloss:0.30709\n",
      "[959]\ttrain-logloss:0.18369\teval-logloss:0.30712\n",
      "[960]\ttrain-logloss:0.18361\teval-logloss:0.30706\n",
      "[961]\ttrain-logloss:0.18354\teval-logloss:0.30720\n",
      "[962]\ttrain-logloss:0.18339\teval-logloss:0.30718\n",
      "[963]\ttrain-logloss:0.18325\teval-logloss:0.30716\n",
      "[964]\ttrain-logloss:0.18321\teval-logloss:0.30713\n",
      "[965]\ttrain-logloss:0.18318\teval-logloss:0.30725\n",
      "[966]\ttrain-logloss:0.18312\teval-logloss:0.30727\n",
      "[967]\ttrain-logloss:0.18308\teval-logloss:0.30721\n",
      "[968]\ttrain-logloss:0.18308\teval-logloss:0.30726\n",
      "[969]\ttrain-logloss:0.18306\teval-logloss:0.30729\n",
      "[970]\ttrain-logloss:0.18294\teval-logloss:0.30725\n",
      "[971]\ttrain-logloss:0.18285\teval-logloss:0.30732\n",
      "[972]\ttrain-logloss:0.18282\teval-logloss:0.30735\n",
      "[973]\ttrain-logloss:0.18275\teval-logloss:0.30740\n",
      "[974]\ttrain-logloss:0.18266\teval-logloss:0.30745\n",
      "[975]\ttrain-logloss:0.18261\teval-logloss:0.30748\n",
      "[976]\ttrain-logloss:0.18257\teval-logloss:0.30749\n",
      "[977]\ttrain-logloss:0.18252\teval-logloss:0.30749\n",
      "[978]\ttrain-logloss:0.18234\teval-logloss:0.30741\n",
      "[979]\ttrain-logloss:0.18228\teval-logloss:0.30745\n",
      "[980]\ttrain-logloss:0.18224\teval-logloss:0.30749\n",
      "[981]\ttrain-logloss:0.18220\teval-logloss:0.30758\n",
      "[982]\ttrain-logloss:0.18215\teval-logloss:0.30761\n",
      "[983]\ttrain-logloss:0.18208\teval-logloss:0.30756\n",
      "[984]\ttrain-logloss:0.18204\teval-logloss:0.30755\n",
      "[985]\ttrain-logloss:0.18198\teval-logloss:0.30752\n",
      "[986]\ttrain-logloss:0.18194\teval-logloss:0.30757\n",
      "[987]\ttrain-logloss:0.18193\teval-logloss:0.30756\n",
      "[988]\ttrain-logloss:0.18190\teval-logloss:0.30760\n",
      "[989]\ttrain-logloss:0.18185\teval-logloss:0.30771\n",
      "[990]\ttrain-logloss:0.18178\teval-logloss:0.30782\n",
      "[991]\ttrain-logloss:0.18175\teval-logloss:0.30785\n",
      "[992]\ttrain-logloss:0.18170\teval-logloss:0.30786\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[993]\ttrain-logloss:0.18163\teval-logloss:0.30785\n",
      "[994]\ttrain-logloss:0.18159\teval-logloss:0.30782\n",
      "[995]\ttrain-logloss:0.18148\teval-logloss:0.30783\n",
      "[996]\ttrain-logloss:0.18143\teval-logloss:0.30783\n",
      "[997]\ttrain-logloss:0.18135\teval-logloss:0.30785\n",
      "[998]\ttrain-logloss:0.18129\teval-logloss:0.30784\n",
      "[999]\ttrain-logloss:0.18121\teval-logloss:0.30784\n"
     ]
    }
   ],
   "source": [
    "# train 데이터 세트는 'train', evaluation(test) 데이터 세트는 'eval'로 명기\n",
    "wlist = [(dtrain, 'train'),(dtest, 'eval')]\n",
    "# 하이퍼 파라미터와 early stoppinig 파라미터를 train() 함수의 파라미터로 전달\n",
    "xgb_model = xgb.train(params=params, dtrain=dtrain, num_boost_round=num_rounds, evals=wlist)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "predict() 수행 결과값을 10개만 표시, 예측 확률값으로 표시됨\n",
      "[0.093 0.397 1.    1.    0.999 0.557 0.652 0.175 0.089 0.459]\n"
     ]
    }
   ],
   "source": [
    "pred_probs = xgb_model.predict(dtest)\n",
    "print('predict() 수행 결과값을 10개만 표시, 예측 확률값으로 표시됨')\n",
    "print(np.round(pred_probs[:10], 3))\n",
    "\n",
    "preds = [1 if x > 0.5 else 0 for x in pred_probs]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "오차행렬\n",
      "[[2551  700]\n",
      " [ 799 5719]]\n",
      "정확도: 0.8466, 정밀도: 0.8909, 재현율: 0.8774\n"
     ]
    }
   ],
   "source": [
    "get_clf_eval(y_test, preds)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#https://greatjoy.tistory.com/72\n",
    "#lightgbm 설명"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 305,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[LightGBM] [Warning] Unknown parameter: 0.01\n",
      "[LightGBM] [Warning] Unknown parameter: nrounds\n",
      "[LightGBM] [Warning] Find whitespaces in feature_names, replace with underlines\n",
      "[LightGBM] [Warning] Unknown parameter: 0.01\n",
      "[LightGBM] [Warning] Unknown parameter: nrounds\n",
      "[LightGBM] [Info] Number of positive: 15272, number of negative: 7520\n",
      "[LightGBM] [Warning] Auto-choosing row-wise multi-threading, the overhead of testing was 0.001270 seconds.\n",
      "You can set `force_row_wise=true` to remove the overhead.\n",
      "And if memory is not enough, you can set `force_col_wise=true`.\n",
      "[LightGBM] [Info] Total Bins 694\n",
      "[LightGBM] [Info] Number of data points in the train set: 22792, number of used features: 20\n",
      "[LightGBM] [Warning] Unknown parameter: 0.01\n",
      "[LightGBM] [Warning] Unknown parameter: nrounds\n",
      "[LightGBM] [Warning] Find whitespaces in feature_names, replace with underlines\n",
      "[LightGBM] [Info] [binary:BoostFromScore]: pavg=0.670060 -> initscore=0.708455\n",
      "[LightGBM] [Info] Start training from score 0.708455\n",
      "Training until validation scores don't improve for 3000 rounds\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[100]\tvalid_0's binary_logloss: 0.299322\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[200]\tvalid_0's binary_logloss: 0.29369\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[300]\tvalid_0's binary_logloss: 0.293183\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[400]\tvalid_0's binary_logloss: 0.293501\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[500]\tvalid_0's binary_logloss: 0.293726\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[600]\tvalid_0's binary_logloss: 0.294652\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[700]\tvalid_0's binary_logloss: 0.295446\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[800]\tvalid_0's binary_logloss: 0.296513\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[900]\tvalid_0's binary_logloss: 0.297855\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[LightGBM] [Warning] No further splits with positive gain, best gain: -inf\n",
      "[1000]\tvalid_0's binary_logloss: 0.298367\n",
      "Did not meet early stopping. Best iteration is:\n",
      "[265]\tvalid_0's binary_logloss: 0.292411\n"
     ]
    }
   ],
   "source": [
    "import lightgbm as lgb\n",
    "train_ds = lgb.Dataset(X_train,label=y_train)\n",
    "test_ds=lgb.Dataset(X_test,label=y_test)\n",
    "params = {'learning_rate ': 0.01,\n",
    "         'max_depth':3,\n",
    "         'boosting' : 'gbdt',\n",
    "         'objective':'binary',\n",
    "         'metric':'binary_logloss',\n",
    "         'is_training_metric':True,\n",
    "         'num_leaves':144,\n",
    "         'nrounds':1500,\n",
    "         'feature_fraction':0.9,\n",
    "         'bagging_fraction':0.7,\n",
    "         'bagging_freq':5,\n",
    "         'seed':2020}\n",
    "\n",
    "model=lgb.train(params,train_ds,1000,test_ds,verbose_eval=100,early_stopping_rounds=3000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 306,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "predict() 수행 결과값을 10개만 표시, 예측 확률값으로 표시됨\n",
      "[0.08  0.494 0.999 1.    0.98  0.633 0.452 0.24  0.104 0.234]\n"
     ]
    }
   ],
   "source": [
    "pred_probs = model.predict(X_test)\n",
    "print('predict() 수행 결과값을 10개만 표시, 예측 확률값으로 표시됨')\n",
    "print(np.round(pred_probs[:10], 3))\n",
    "\n",
    "preds = [1 if x > 0.5 else 0 for x in pred_probs]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "오차행렬\n",
      "[[2612  639]\n",
      " [ 861 5657]]\n",
      "정확도: 0.8465, 정밀도: 0.8985, 재현율: 0.8679\n"
     ]
    }
   ],
   "source": [
    "get_clf_eval(y_test, preds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 308,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, ExtraTreesClassifier, BaggingClassifier, GradientBoostingClassifier\n",
    "from sklearn.svm import SVC\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.ensemble import VotingClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 309,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>226802</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>Black</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>89814</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Farming-fishing</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>Local-gov</td>\n",
       "      <td>336951</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Protective-serv</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>Private</td>\n",
       "      <td>160323</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>7688</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>103497</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이       노동 계급  fnlwgt             학력  교육 수                혼인 상태  \\\n",
       "0  H00001  25     Private  226802           11th     7        Never-married   \n",
       "1  H00002  38     Private   89814        HS-grad     9   Married-civ-spouse   \n",
       "2  H00003  28   Local-gov  336951     Assoc-acdm    12   Married-civ-spouse   \n",
       "3  H00004  44     Private  160323   Some-college    10   Married-civ-spouse   \n",
       "4  H00005  18         NaN  103497   Some-college    10        Never-married   \n",
       "\n",
       "                   직업          관계      인종  자본 이득  자본 손실  주당 시간              모국  \n",
       "0   Machine-op-inspct   Own-child   Black      0      0     40   United-States  \n",
       "1     Farming-fishing     Husband   White      0      0     50   United-States  \n",
       "2     Protective-serv     Husband   White      0      0     40   United-States  \n",
       "3   Machine-op-inspct     Husband   Black   7688      0     40   United-States  \n",
       "4                 NaN   Own-child   White      0      0     30   United-States  "
      ]
     },
     "execution_count": 309,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new = pd.read_csv('human_new.csv', encoding='cp949')\n",
    "new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 310,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>성별</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.301370</td>\n",
       "      <td>0.857143</td>\n",
       "      <td>0.044302</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.800000</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.452055</td>\n",
       "      <td>0.714286</td>\n",
       "      <td>0.048238</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.800000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.230769</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.122449</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.287671</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.138113</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.384615</td>\n",
       "      <td>0.2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.493151</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.151068</td>\n",
       "      <td>0.066667</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.384615</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.150685</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.221488</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.800000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.10</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32556</th>\n",
       "      <td>0.136986</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.166404</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.923077</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.377551</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32557</th>\n",
       "      <td>0.315068</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.096500</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32558</th>\n",
       "      <td>0.561644</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.094827</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.8</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32559</th>\n",
       "      <td>0.068493</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.128499</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.193878</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32560</th>\n",
       "      <td>0.479452</td>\n",
       "      <td>0.571429</td>\n",
       "      <td>0.187203</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.230769</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.95</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>32561 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "             나이     노동 계급    fnlwgt        학력      교육 수     혼인 상태        직업  \\\n",
       "0      0.301370  0.857143  0.044302  0.600000  0.800000  0.666667  0.000000   \n",
       "1      0.452055  0.714286  0.048238  0.600000  0.800000  0.333333  0.230769   \n",
       "2      0.287671  0.428571  0.138113  0.733333  0.533333  0.000000  0.384615   \n",
       "3      0.493151  0.428571  0.151068  0.066667  0.400000  0.333333  0.384615   \n",
       "4      0.150685  0.428571  0.221488  0.600000  0.800000  0.333333  0.692308   \n",
       "...         ...       ...       ...       ...       ...       ...       ...   \n",
       "32556  0.136986  0.428571  0.166404  0.466667  0.733333  0.333333  0.923077   \n",
       "32557  0.315068  0.428571  0.096500  0.733333  0.533333  0.333333  0.461538   \n",
       "32558  0.561644  0.428571  0.094827  0.733333  0.533333  1.000000  0.000000   \n",
       "32559  0.068493  0.428571  0.128499  0.733333  0.533333  0.666667  0.000000   \n",
       "32560  0.479452  0.571429  0.187203  0.733333  0.533333  0.333333  0.230769   \n",
       "\n",
       "        관계   인종   성별  ...  자본 손실     주당 시간    모국    주당 시간2  혼인 상태2  Not_white  \\\n",
       "0      0.2  1.0  1.0  ...    0.0  0.397959  0.95  0.666667     0.0        0.0   \n",
       "1      0.0  1.0  1.0  ...    0.0  0.122449  0.95  0.333333     0.5        0.0   \n",
       "2      0.2  1.0  1.0  ...    0.0  0.397959  0.95  0.666667     1.0        0.0   \n",
       "3      0.0  0.5  1.0  ...    0.0  0.397959  0.95  0.666667     0.5        1.0   \n",
       "4      1.0  0.5  0.0  ...    0.0  0.397959  0.10  0.666667     0.5        1.0   \n",
       "...    ...  ...  ...  ...    ...       ...   ...       ...     ...        ...   \n",
       "32556  1.0  1.0  0.0  ...    0.0  0.377551  0.95  0.666667     0.5        0.0   \n",
       "32557  0.0  1.0  1.0  ...    0.0  0.397959  0.95  0.666667     0.5        0.0   \n",
       "32558  0.8  1.0  0.0  ...    0.0  0.397959  0.95  0.666667     1.0        0.0   \n",
       "32559  0.6  1.0  1.0  ...    0.0  0.193878  0.95  0.333333     0.0        0.0   \n",
       "32560  1.0  1.0  0.0  ...    0.0  0.397959  0.95  0.666667     0.5        0.0   \n",
       "\n",
       "        Hw   Lw   Mw  Vhw  \n",
       "0      0.0  0.0  1.0  0.0  \n",
       "1      0.0  1.0  0.0  0.0  \n",
       "2      0.0  0.0  1.0  0.0  \n",
       "3      0.0  0.0  1.0  0.0  \n",
       "4      0.0  0.0  1.0  0.0  \n",
       "...    ...  ...  ...  ...  \n",
       "32556  0.0  0.0  1.0  0.0  \n",
       "32557  0.0  0.0  1.0  0.0  \n",
       "32558  0.0  0.0  1.0  0.0  \n",
       "32559  0.0  1.0  0.0  0.0  \n",
       "32560  0.0  0.0  1.0  0.0  \n",
       "\n",
       "[32561 rows x 21 columns]"
      ]
     },
     "execution_count": 310,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mdfS"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 311,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>아이디</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>H52099</th>\n",
       "      <td>45</td>\n",
       "      <td>3</td>\n",
       "      <td>170871</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>7298</td>\n",
       "      <td>0</td>\n",
       "      <td>60</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>H45207</th>\n",
       "      <td>47</td>\n",
       "      <td>6</td>\n",
       "      <td>108890</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>1831</td>\n",
       "      <td>0</td>\n",
       "      <td>38</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>H43492</th>\n",
       "      <td>48</td>\n",
       "      <td>3</td>\n",
       "      <td>187505</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>38</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>H32368</th>\n",
       "      <td>29</td>\n",
       "      <td>3</td>\n",
       "      <td>145592</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>H27055</th>\n",
       "      <td>23</td>\n",
       "      <td>3</td>\n",
       "      <td>203003</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>25</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        나이  노동 계급  fnlwgt  학력  교육 수  혼인 상태  직업  관계  인종  자본 이득  자본 손실  주당 시간  \\\n",
       "아이디                                                                           \n",
       "H52099  45      3  170871  11     9      2   2   0   4   7298      0     60   \n",
       "H45207  47      6  108890  11     9      0   0   4   4   1831      0     38   \n",
       "H43492  48      3  187505  15    10      2  11   0   4      0      0     50   \n",
       "H32368  29      3  145592  11     9      4   2   1   4      0      0     40   \n",
       "H27055  23      3  203003   5     4      4   2   1   4      0      0     25   \n",
       "\n",
       "        모국  주당 시간2  혼인 상태2  Not_white  Hw  Lw  Mw  Vhw  \n",
       "아이디                                                     \n",
       "H52099  38       2       1        0.0   0   0   1    0  \n",
       "H45207  38       2       2        0.0   0   0   1    0  \n",
       "H43492  38       2       1        0.0   0   0   1    0  \n",
       "H32368  12       2       0        0.0   0   0   1    0  \n",
       "H27055  10       1       0        0.0   0   1   0    0  "
      ]
     },
     "execution_count": 311,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X_train.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 312,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>226802</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>Black</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>89814</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Farming-fishing</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>Local-gov</td>\n",
       "      <td>336951</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Protective-serv</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>Private</td>\n",
       "      <td>160323</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>7688</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>103497</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16276</th>\n",
       "      <td>H16277</td>\n",
       "      <td>20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>216672</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16277</th>\n",
       "      <td>H16278</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>61956</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>4650</td>\n",
       "      <td>0</td>\n",
       "      <td>45</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16278</th>\n",
       "      <td>H16279</td>\n",
       "      <td>33</td>\n",
       "      <td>Private</td>\n",
       "      <td>157216</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Sales</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16279</th>\n",
       "      <td>H16280</td>\n",
       "      <td>68</td>\n",
       "      <td>NaN</td>\n",
       "      <td>150250</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>1510</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16280</th>\n",
       "      <td>H16281</td>\n",
       "      <td>37</td>\n",
       "      <td>Private</td>\n",
       "      <td>112838</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>55</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>16281 rows × 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이       노동 계급  fnlwgt             학력  교육 수  \\\n",
       "0      H00001  25     Private  226802           11th     7   \n",
       "1      H00002  38     Private   89814        HS-grad     9   \n",
       "2      H00003  28   Local-gov  336951     Assoc-acdm    12   \n",
       "3      H00004  44     Private  160323   Some-college    10   \n",
       "4      H00005  18         NaN  103497   Some-college    10   \n",
       "...       ...  ..         ...     ...            ...   ...   \n",
       "16276  H16277  20         NaN  216672   Some-college    10   \n",
       "16277  H16278  25     Private   61956      Bachelors    13   \n",
       "16278  H16279  33     Private  157216        Masters    14   \n",
       "16279  H16280  68         NaN  150250        Masters    14   \n",
       "16280  H16281  37     Private  112838        Masters    14   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  자본 이득  \\\n",
       "0            Never-married   Machine-op-inspct       Own-child   Black      0   \n",
       "1       Married-civ-spouse     Farming-fishing         Husband   White      0   \n",
       "2       Married-civ-spouse     Protective-serv         Husband   White      0   \n",
       "3       Married-civ-spouse   Machine-op-inspct         Husband   Black   7688   \n",
       "4            Never-married                 NaN       Own-child   White      0   \n",
       "...                    ...                 ...             ...     ...    ...   \n",
       "16276        Never-married                 NaN       Own-child   White      0   \n",
       "16277        Never-married     Exec-managerial       Own-child   White   4650   \n",
       "16278        Never-married               Sales   Not-in-family   White      0   \n",
       "16279   Married-civ-spouse                 NaN         Husband   White      0   \n",
       "16280   Married-civ-spouse     Exec-managerial         Husband   White      0   \n",
       "\n",
       "       자본 손실  주당 시간              모국 주당 시간2  \n",
       "0          0     40   United-States     Mw  \n",
       "1          0     50   United-States     Mw  \n",
       "2          0     40   United-States     Mw  \n",
       "3          0     40   United-States     Mw  \n",
       "4          0     30   United-States     Lw  \n",
       "...      ...    ...             ...    ...  \n",
       "16276      0     30   United-States     Lw  \n",
       "16277      0     45   United-States     Mw  \n",
       "16278      0     40   United-States     Mw  \n",
       "16279   1510     30   United-States     Lw  \n",
       "16280      0     55   United-States     Mw  \n",
       "\n",
       "[16281 rows x 15 columns]"
      ]
     },
     "execution_count": 312,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new['주당 시간2']='Lw'\n",
    "new.loc[new['주당 시간']<=30,'주당 시간2']='Lw'\n",
    "new.loc[(new['주당 시간']>30)&(new['주당 시간']<=60),'주당 시간2']='Mw'\n",
    "new.loc[(new['주당 시간']>60)&(new['주당 시간']<=90),'주당 시간2']='Hw'\n",
    "new.loc[new['주당 시간']>90,'주당 시간2']='Vhw'\n",
    "new"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 313,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>226802</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>Black</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>89814</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Farming-fishing</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>Local-gov</td>\n",
       "      <td>336951</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Protective-serv</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>Private</td>\n",
       "      <td>160323</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>7688</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>103497</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이       노동 계급  fnlwgt             학력  교육 수                혼인 상태  \\\n",
       "0  H00001  25     Private  226802           11th     7        Never-married   \n",
       "1  H00002  38     Private   89814        HS-grad     9   Married-civ-spouse   \n",
       "2  H00003  28   Local-gov  336951     Assoc-acdm    12   Married-civ-spouse   \n",
       "3  H00004  44     Private  160323   Some-college    10   Married-civ-spouse   \n",
       "4  H00005  18         NaN  103497   Some-college    10        Never-married   \n",
       "\n",
       "                   직업          관계      인종  자본 이득  자본 손실  주당 시간  \\\n",
       "0   Machine-op-inspct   Own-child   Black      0      0     40   \n",
       "1     Farming-fishing     Husband   White      0      0     50   \n",
       "2     Protective-serv     Husband   White      0      0     40   \n",
       "3   Machine-op-inspct     Husband   Black   7688      0     40   \n",
       "4                 NaN   Own-child   White      0      0     30   \n",
       "\n",
       "               모국 주당 시간2 혼인 상태2  \n",
       "0   United-States     Mw    NaN  \n",
       "1   United-States     Mw    Ma2  \n",
       "2   United-States     Mw    Ma2  \n",
       "3   United-States     Mw    Ma2  \n",
       "4   United-States     Lw    NaN  "
      ]
     },
     "execution_count": 313,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new.loc[(new['혼인 상태'] == ' Never-married '), '혼인 상태2'] = 'Ma1'\n",
    "new.loc[(new['혼인 상태'] == ' Married-civ-spouse') |\n",
    "        (new['혼인 상태'] == ' Married-spouse-absent') |\n",
    "        (new['혼인 상태'] == ' Married-AF-spouse'), '혼인 상태2'] = 'Ma2'\n",
    "new.loc[(new['혼인 상태'] == ' Divorced') |\n",
    "        (new['혼인 상태'] == ' Separated') |\n",
    "        (new['혼인 상태'] == ' Widowed'), '혼인 상태2'] = 'Ma3'\n",
    "new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 314,
   "metadata": {},
   "outputs": [],
   "source": [
    "new.loc[(new.인종 ==' Other')|\n",
    "                   (new.인종 ==' Amer-Indian-Eskimo')|\n",
    "                   (new.인종 ==' Asian-Pac-Islander')|\n",
    "                   (new.인종 ==' Black'), 'Not_white'] = 1\n",
    "new.loc[(new.인종 ==' White'), 'Not_white'] = 0"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#Hi_Ac = \n",
    "\n",
    "new.loc[(new['학력'] == 0)|\n",
    "          (new['학력'] == 1)|\n",
    "          (new['학력'] ==2)|\n",
    "          (new['학력'] ==3)|\n",
    "          (new['학력'] ==4)|\n",
    "          (new['학력'] ==5)|\n",
    "          (new['학력'] ==6)|\n",
    "          (new['학력'] ==7)|\n",
    "          (new['학력'] ==11)|\n",
    "           (new['학력']==13),'Hi_Ac'] = 0\n",
    "new.loc[(new['학력'] == 10)|\n",
    "          (new['학력'] == 14)|\n",
    "          (new['학력'] ==15)|\n",
    "          (new['학력'] == 12)|\n",
    "          (new['학력'] == 8)|\n",
    "          (new['학력'] ==9),'Hi_Ac'] = 1\n",
    "#Lo_Ac = "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "new.loc[(new['학력'] !=10)|\n",
    "           (new['학력'] !=9)|\n",
    "           (new['학력'] !=12),'Master'] = 0\n",
    "\n",
    "new.loc[(new['학력'] ==10)|\n",
    "           (new['학력'] ==9)|\n",
    "           (new['학력'] ==12),'Master'] = 1\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 315,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>226802</td>\n",
       "      <td>11th</td>\n",
       "      <td>7</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>Private</td>\n",
       "      <td>89814</td>\n",
       "      <td>HS-grad</td>\n",
       "      <td>9</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Farming-fishing</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>Local-gov</td>\n",
       "      <td>336951</td>\n",
       "      <td>Assoc-acdm</td>\n",
       "      <td>12</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Protective-serv</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>Private</td>\n",
       "      <td>160323</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Machine-op-inspct</td>\n",
       "      <td>Husband</td>\n",
       "      <td>Black</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>NaN</td>\n",
       "      <td>103497</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16276</th>\n",
       "      <td>H16277</td>\n",
       "      <td>20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>216672</td>\n",
       "      <td>Some-college</td>\n",
       "      <td>10</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16277</th>\n",
       "      <td>H16278</td>\n",
       "      <td>25</td>\n",
       "      <td>Private</td>\n",
       "      <td>61956</td>\n",
       "      <td>Bachelors</td>\n",
       "      <td>13</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Own-child</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>45</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16278</th>\n",
       "      <td>H16279</td>\n",
       "      <td>33</td>\n",
       "      <td>Private</td>\n",
       "      <td>157216</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Never-married</td>\n",
       "      <td>Sales</td>\n",
       "      <td>Not-in-family</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16279</th>\n",
       "      <td>H16280</td>\n",
       "      <td>68</td>\n",
       "      <td>NaN</td>\n",
       "      <td>150250</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>1510</td>\n",
       "      <td>30</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Lw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16280</th>\n",
       "      <td>H16281</td>\n",
       "      <td>37</td>\n",
       "      <td>Private</td>\n",
       "      <td>112838</td>\n",
       "      <td>Masters</td>\n",
       "      <td>14</td>\n",
       "      <td>Married-civ-spouse</td>\n",
       "      <td>Exec-managerial</td>\n",
       "      <td>Husband</td>\n",
       "      <td>White</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>55</td>\n",
       "      <td>United-States</td>\n",
       "      <td>Mw</td>\n",
       "      <td>Ma2</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>16281 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          아이디  나이       노동 계급  fnlwgt             학력  교육 수  \\\n",
       "0      H00001  25     Private  226802           11th     7   \n",
       "1      H00002  38     Private   89814        HS-grad     9   \n",
       "2      H00003  28   Local-gov  336951     Assoc-acdm    12   \n",
       "3      H00004  44     Private  160323   Some-college    10   \n",
       "4      H00005  18         NaN  103497   Some-college    10   \n",
       "...       ...  ..         ...     ...            ...   ...   \n",
       "16276  H16277  20         NaN  216672   Some-college    10   \n",
       "16277  H16278  25     Private   61956      Bachelors    13   \n",
       "16278  H16279  33     Private  157216        Masters    14   \n",
       "16279  H16280  68         NaN  150250        Masters    14   \n",
       "16280  H16281  37     Private  112838        Masters    14   \n",
       "\n",
       "                     혼인 상태                  직업              관계      인종  ...  \\\n",
       "0            Never-married   Machine-op-inspct       Own-child   Black  ...   \n",
       "1       Married-civ-spouse     Farming-fishing         Husband   White  ...   \n",
       "2       Married-civ-spouse     Protective-serv         Husband   White  ...   \n",
       "3       Married-civ-spouse   Machine-op-inspct         Husband   Black  ...   \n",
       "4            Never-married                 NaN       Own-child   White  ...   \n",
       "...                    ...                 ...             ...     ...  ...   \n",
       "16276        Never-married                 NaN       Own-child   White  ...   \n",
       "16277        Never-married     Exec-managerial       Own-child   White  ...   \n",
       "16278        Never-married               Sales   Not-in-family   White  ...   \n",
       "16279   Married-civ-spouse                 NaN         Husband   White  ...   \n",
       "16280   Married-civ-spouse     Exec-managerial         Husband   White  ...   \n",
       "\n",
       "       자본 손실  주당 시간              모국 주당 시간2 혼인 상태2 Not_white  Hw  Lw  Mw  Vhw  \n",
       "0          0     40   United-States     Mw    NaN       1.0   0   0   1    0  \n",
       "1          0     50   United-States     Mw    Ma2       0.0   0   0   1    0  \n",
       "2          0     40   United-States     Mw    Ma2       0.0   0   0   1    0  \n",
       "3          0     40   United-States     Mw    Ma2       1.0   0   0   1    0  \n",
       "4          0     30   United-States     Lw    NaN       0.0   0   1   0    0  \n",
       "...      ...    ...             ...    ...    ...       ...  ..  ..  ..  ...  \n",
       "16276      0     30   United-States     Lw    NaN       0.0   0   1   0    0  \n",
       "16277      0     45   United-States     Mw    NaN       0.0   0   0   1    0  \n",
       "16278      0     40   United-States     Mw    NaN       0.0   0   0   1    0  \n",
       "16279   1510     30   United-States     Lw    Ma2       0.0   0   1   0    0  \n",
       "16280      0     55   United-States     Mw    Ma2       0.0   0   0   1    0  \n",
       "\n",
       "[16281 rows x 21 columns]"
      ]
     },
     "execution_count": 315,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_n2 = pd.get_dummies(new['주당 시간2'])\n",
    "# 합치기\n",
    "new = pd.concat([new, new_n2], axis=1)\n",
    "new"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 316,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "아이디             0\n",
       "나이              0\n",
       "노동 계급         963\n",
       "fnlwgt          0\n",
       "학력              0\n",
       "교육 수            0\n",
       "혼인 상태           0\n",
       "직업            966\n",
       "관계              0\n",
       "인종              0\n",
       "자본 이득           0\n",
       "자본 손실           0\n",
       "주당 시간           0\n",
       "모국            274\n",
       "주당 시간2          0\n",
       "혼인 상태2       5434\n",
       "Not_white       0\n",
       "Hw              0\n",
       "Lw              0\n",
       "Mw              0\n",
       "Vhw             0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 316,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 317,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 16281 entries, 0 to 16280\n",
      "Data columns (total 21 columns):\n",
      " #   Column     Non-Null Count  Dtype  \n",
      "---  ------     --------------  -----  \n",
      " 0   아이디        16281 non-null  object \n",
      " 1   나이         16281 non-null  int64  \n",
      " 2   노동 계급      15318 non-null  object \n",
      " 3   fnlwgt     16281 non-null  int64  \n",
      " 4   학력         16281 non-null  object \n",
      " 5   교육 수       16281 non-null  int64  \n",
      " 6   혼인 상태      16281 non-null  object \n",
      " 7   직업         15315 non-null  object \n",
      " 8   관계         16281 non-null  object \n",
      " 9   인종         16281 non-null  object \n",
      " 10  자본 이득      16281 non-null  int64  \n",
      " 11  자본 손실      16281 non-null  int64  \n",
      " 12  주당 시간      16281 non-null  int64  \n",
      " 13  모국         16007 non-null  object \n",
      " 14  주당 시간2     16281 non-null  object \n",
      " 15  혼인 상태2     10847 non-null  object \n",
      " 16  Not_white  16281 non-null  float64\n",
      " 17  Hw         16281 non-null  uint8  \n",
      " 18  Lw         16281 non-null  uint8  \n",
      " 19  Mw         16281 non-null  uint8  \n",
      " 20  Vhw        16281 non-null  uint8  \n",
      "dtypes: float64(1), int64(6), object(10), uint8(4)\n",
      "memory usage: 2.2+ MB\n"
     ]
    }
   ],
   "source": [
    "new.info()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 319,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.impute import SimpleImputer\n",
    "imputer_con = SimpleImputer(strategy=\"most_frequent\")  \n",
    "con = ['노동 계급', '학력', '혼인 상태', '직업', '관계', '인종', '모국']\n",
    "new[con]=imputer_con.fit_transform(new[con])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 320,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>3</td>\n",
       "      <td>226802</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>3</td>\n",
       "      <td>89814</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>1</td>\n",
       "      <td>336951</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>3</td>\n",
       "      <td>160323</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>3</td>\n",
       "      <td>103497</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>37</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이  노동 계급  fnlwgt  학력  교육 수  혼인 상태  직업  관계  인종  ...  자본 손실  주당 시간  \\\n",
       "0  H00001  25      3  226802   1     7      4   6   3   2  ...      0     40   \n",
       "1  H00002  38      3   89814  11     9      2   4   0   4  ...      0     50   \n",
       "2  H00003  28      1  336951   7    12      2  10   0   4  ...      0     40   \n",
       "3  H00004  44      3  160323  15    10      2   6   0   2  ...      0     40   \n",
       "4  H00005  18      3  103497  15    10      4   9   3   4  ...      0     30   \n",
       "\n",
       "   모국  주당 시간2  혼인 상태2  Not_white  Hw  Lw  Mw  Vhw  \n",
       "0  37       2      -1        1.0   0   0   1    0  \n",
       "1  37       2       0        0.0   0   0   1    0  \n",
       "2  37       2       0        0.0   0   0   1    0  \n",
       "3  37       2       0        1.0   0   0   1    0  \n",
       "4  37       1      -1        0.0   0   1   0    0  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 320,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obj1 = ['노동 계급', '학력', '혼인 상태', '직업', '관계', '인종', '모국','주당 시간2', '혼인 상태2']\n",
    "new[obj1] = new[obj1].apply(lambda x: x.astype('category').cat.codes)\n",
    "new.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 321,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>아이디</th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>...</th>\n",
       "      <th>자본 손실</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>25</td>\n",
       "      <td>3</td>\n",
       "      <td>226802</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "      <td>4</td>\n",
       "      <td>6</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>38</td>\n",
       "      <td>3</td>\n",
       "      <td>89814</td>\n",
       "      <td>11</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>50</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>28</td>\n",
       "      <td>1</td>\n",
       "      <td>336951</td>\n",
       "      <td>7</td>\n",
       "      <td>12</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>44</td>\n",
       "      <td>3</td>\n",
       "      <td>160323</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>40</td>\n",
       "      <td>37</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>18</td>\n",
       "      <td>3</td>\n",
       "      <td>103497</td>\n",
       "      <td>15</td>\n",
       "      <td>10</td>\n",
       "      <td>4</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>30</td>\n",
       "      <td>37</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      아이디  나이  노동 계급  fnlwgt  학력  교육 수  혼인 상태  직업  관계  인종  ...  자본 손실  주당 시간  \\\n",
       "0  H00001  25      3  226802   1     7      4   6   3   2  ...      0     40   \n",
       "1  H00002  38      3   89814  11     9      2   4   0   4  ...      0     50   \n",
       "2  H00003  28      1  336951   7    12      2  10   0   4  ...      0     40   \n",
       "3  H00004  44      3  160323  15    10      2   6   0   2  ...      0     40   \n",
       "4  H00005  18      3  103497  15    10      4   9   3   4  ...      0     30   \n",
       "\n",
       "   모국  주당 시간2  혼인 상태2  Not_white  Hw  Lw  Mw  Vhw  \n",
       "0  37       2      -1        1.0   0   0   1    0  \n",
       "1  37       2       0        0.0   0   0   1    0  \n",
       "2  37       2       0        0.0   0   0   1    0  \n",
       "3  37       2       0        1.0   0   0   1    0  \n",
       "4  37       1      -1        0.0   0   1   0    0  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 321,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ndf = new.copy()\n",
    "ndf.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 325,
   "metadata": {},
   "outputs": [],
   "source": [
    "ndfS=ndf.set_index('아이디')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 326,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MinMaxScaler()"
      ]
     },
     "execution_count": 326,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "scaler = MinMaxScaler()\n",
    "scaler.fit(ndfS)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 327,
   "metadata": {},
   "outputs": [],
   "source": [
    "x = scaler.transform(ndfS)\n",
    "ndfS = pd.DataFrame(x, columns=ndfS.columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 329,
   "metadata": {},
   "outputs": [],
   "source": [
    "ndfS['성별']=model.predict(ndfS.loc[:,'나이':'Vhw'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 330,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>나이</th>\n",
       "      <th>노동 계급</th>\n",
       "      <th>fnlwgt</th>\n",
       "      <th>학력</th>\n",
       "      <th>교육 수</th>\n",
       "      <th>혼인 상태</th>\n",
       "      <th>직업</th>\n",
       "      <th>관계</th>\n",
       "      <th>인종</th>\n",
       "      <th>자본 이득</th>\n",
       "      <th>...</th>\n",
       "      <th>주당 시간</th>\n",
       "      <th>모국</th>\n",
       "      <th>주당 시간2</th>\n",
       "      <th>혼인 상태2</th>\n",
       "      <th>Not_white</th>\n",
       "      <th>Hw</th>\n",
       "      <th>Lw</th>\n",
       "      <th>Mw</th>\n",
       "      <th>Vhw</th>\n",
       "      <th>성별</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0.109589</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.144430</td>\n",
       "      <td>0.066667</td>\n",
       "      <td>0.400000</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.6</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.948718</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.894816</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.287671</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.051677</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.533333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.307692</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.500000</td>\n",
       "      <td>0.948718</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.999845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.150685</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>0.219011</td>\n",
       "      <td>0.466667</td>\n",
       "      <td>0.733333</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.769231</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.948718</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.999845</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0.369863</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.099418</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.461538</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.076881</td>\n",
       "      <td>...</td>\n",
       "      <td>0.397959</td>\n",
       "      <td>0.948718</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.999859</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.013699</td>\n",
       "      <td>0.428571</td>\n",
       "      <td>0.060942</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.600000</td>\n",
       "      <td>0.666667</td>\n",
       "      <td>0.692308</td>\n",
       "      <td>0.6</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>...</td>\n",
       "      <td>0.295918</td>\n",
       "      <td>0.948718</td>\n",
       "      <td>0.333333</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.892934</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         나이     노동 계급    fnlwgt        학력      교육 수     혼인 상태        직업   관계  \\\n",
       "0  0.109589  0.428571  0.144430  0.066667  0.400000  0.666667  0.461538  0.6   \n",
       "1  0.287671  0.428571  0.051677  0.733333  0.533333  0.333333  0.307692  0.0   \n",
       "2  0.150685  0.142857  0.219011  0.466667  0.733333  0.333333  0.769231  0.0   \n",
       "3  0.369863  0.428571  0.099418  1.000000  0.600000  0.333333  0.461538  0.0   \n",
       "4  0.013699  0.428571  0.060942  1.000000  0.600000  0.666667  0.692308  0.6   \n",
       "\n",
       "    인종     자본 이득  ...     주당 시간        모국    주당 시간2  혼인 상태2  Not_white   Hw  \\\n",
       "0  0.5  0.000000  ...  0.397959  0.948718  0.666667     0.0        1.0  0.0   \n",
       "1  1.0  0.000000  ...  0.500000  0.948718  0.666667     0.5        0.0  0.0   \n",
       "2  1.0  0.000000  ...  0.397959  0.948718  0.666667     0.5        0.0  0.0   \n",
       "3  0.5  0.076881  ...  0.397959  0.948718  0.666667     0.5        1.0  0.0   \n",
       "4  1.0  0.000000  ...  0.295918  0.948718  0.333333     0.0        0.0  0.0   \n",
       "\n",
       "    Lw   Mw  Vhw        성별  \n",
       "0  0.0  1.0  0.0  0.894816  \n",
       "1  0.0  1.0  0.0  0.999845  \n",
       "2  0.0  1.0  0.0  0.999845  \n",
       "3  0.0  1.0  0.0  0.999859  \n",
       "4  1.0  0.0  0.0  0.892934  \n",
       "\n",
       "[5 rows x 21 columns]"
      ]
     },
     "execution_count": 330,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ndfS.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 331,
   "metadata": {},
   "outputs": [],
   "source": [
    "ndf_id=pd.concat([ndf['아이디'],ndfS['성별']],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 305,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 16281 entries, 0 to 16280\n",
      "Data columns (total 2 columns):\n",
      " #   Column  Non-Null Count  Dtype  \n",
      "---  ------  --------------  -----  \n",
      " 0   ID      16281 non-null  object \n",
      " 1   SEX     16281 non-null  float64\n",
      "dtypes: float64(1), object(1)\n",
      "memory usage: 254.5+ KB\n"
     ]
    }
   ],
   "source": [
    "ndf_rename.info()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 306,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>SEX</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>H00001</td>\n",
       "      <td>0.702541</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>H00002</td>\n",
       "      <td>0.999976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>H00003</td>\n",
       "      <td>0.999968</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>H00004</td>\n",
       "      <td>0.999927</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>H00005</td>\n",
       "      <td>0.367400</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       ID       SEX\n",
       "0  H00001  0.702541\n",
       "1  H00002  0.999976\n",
       "2  H00003  0.999968\n",
       "3  H00004  0.999927\n",
       "4  H00005  0.367400"
      ]
     },
     "execution_count": 306,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ndf_rename = ndf_id.rename(columns={'아이디':'ID', '성별':'SEX'})\n",
    "ndf_rename.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [],
   "source": [
    "ndf_rename.to_csv('test_2.csv', encoding='cp949', index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
